---
title: "Exploring the composition of lithic assemblages in Mesolithic south-eastern Norway"
author:
  - Isak Roalkvam:
      email: isak.roalkvam@iakh.uio.no
      institute: [UiO]
      correspondence: true
institute:
  - UiO: University of Oslo
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::word_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style
---

<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

<!-- The following code chunk defines some general settings how code chunks should behave. -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.width = 9,
  fig.path = "../figures/",
  dpi = 300
)
```

```{r libraries, eval = TRUE}
library(tidyverse)
library(GGally)
library(ggridges)
library(patchwork)
library(gt)
library(FactoMineR)
library(factoextra)
library(sf)
library(rnaturalearth)
library(oxcAAR)
quickSetupOxcal()
```

```{r get-functions, include = FALSE}
source(here::here("analysis/script/plot_functions.R"), local = knitr::knit_global())

#setOxcalExecutablePath("/tmp/RtmpFVOcBJ")
```

```{r get-data, eval = TRUE, results = 'hide'}
assemblages <- read.csv(here::here('analysis/data/raw_data/assemblage_data.csv'))
radiocarbon <- read.csv(here::here('analysis/data/raw_data/radiocarbon_data.csv'))
site_pts <- st_read(here::here('analysis/data/raw_data/sites.gpkg'))

# ne_download() is currently failing
#countries <- ne_download(scale = 10, type = 'countries', category = 'physical',
#                         returnclass = "sf")
countries <- st_read(here::here('analysis/data/raw_data/naturalearth_countries.gpkg'))

# gis <- read.csv(here::here('../../site_data.csv'))
# gis$askeladden_id <- as.integer(str_replace_all(gis$askeladden_id, c("-1" = "", "-0" = "", "-2" = "", "-3" = "", "-4" = "")))
# gisjoin <- right_join(gis, sites, by = c("askeladden_id" = "askeladden_id"))
```

# Introduction

This study employs multivariate exploratory statistics to analyse the entirety of the lithic assemblages associated with a larger number of Mesolithic sites located in south-eastern Norway. This is done to identify latent patterns and structure in the relationship between the assemblages, with the ultimate aim of identifying behaviourally induced variation in their composition across time. However, the composition of the assemblages can be expected to be determined by a multitude of factors [e.g. @dibble2017; @rezek2020], ranging from the impact of natural formation processes, to various and intermixed behavioural aspects such as purpose, duration, frequency and group sizes at visits to the sites. The assemblages are also likely to be impacted by variation in lithic technology, artefact function, use-life and discard patterns, as well as access to raw materials. Finally, analytical and methodological dimensions relating to survey, excavation and classification practices are also fundamental to how the assemblages are defined. Consequently, the analysis conducted here is done from an exploratory perspective, where all of these factors should be seen as potential contributors to any observed pattern. In an attempt to limit the influence of confounding effects, the material chosen for analysis has a relatively constrained geographical distribution, and stems from relatively recent investigations that have employed comparable methods for excavation and classification.

Even though each individual assemblage can have been impacted by an virtual infinitude of effects that might skew an archaeological interpretation, this does not preclude the applicability of inductive analyses aimed at revealing overarching structure in the data without imposing overly complex analytical frameworks that attempt to account for these particularities [@bevan2015]. Structure that can be revealed from considering all of the assemblages in aggregate can constitute a step in an iterative analytical chain that ultimately aims to tease apart the multitude of factors that have shaped the composition of the assemblages, and should be of value to subsequent in-depth studies of any individual site. The most immediate danger of the approach outlined here is rather to be overly naive in the causal significance and cultural importance that is ascribed to any identified pattern. As such, the main aim of this analysis is to compare the results with findings reported in previous literature concerned with the Mesolithic in southern Norway and have the generation of new hypotheses as a possible outcome. To this end, the analysis follows two analytical avenues. The first involves an analysis of the assemblages using the classification of the artefacts done for the original excavation reports, which consequently assumes that these are behaviourally meaningful. The second involves an analysis of the assemblages in light of the whole assemblage behaviour index, which has not seen application in this context before.

## Archaeological context and material

```{r wrangling}
sites <- assemblages %>% 
      # Find mean reported date for each site (to be used in the plots below)
  rowwise() %>% 
  mutate(mean_date = mean(c(reported_start_bc, reported_end_bc))) %>% 
  mutate(
    # Find total artefact count and flint count for each site
    artefact_count = sum(c_across(core:flake_retouch_other)),
    flint_count = sum(c_across(core:flake_retouch)),
    nonflint_count = sum(c_across(axe_other:flake_retouch_other))) %>%
  # Exclude sites with less than 100 artefacts
  filter(artefact_count > 100)
```

```{r c14-modelling, cache = TRUE}
# define function to model radiocarbon dates. Only assumption is that 
# dates from a single site belong to a single group
model_rcarb <- function(data){
  
  # Format individual dates for R_Date in Oxcal
  dates <- R_Date(data[["lab_code"]], data[["c14_bp"]], data[["error"]])
  
  # Manually compile rest of OxCal code
  oxcal_code <- paste0('
  Plot()
   {
    Sequence()
    {
     Boundary("Start");
     Phase()
     {
    ',
     dates,
     '
     Sum("Sum");
     };
     Boundary("End");
    };
  };')
  
  # Run OxCal code - wrapped this in some functions to  not print to 
  # rmarkdown
  invisible(capture.output(oxcal_exec <- executeOxcalScript(oxcal_code)))
  oxcal_read <- readOxcalOutput(oxcal_exec)
  # Note that parseOxcalOutput() defaults to only returning individual dates,
  # specified with only.R_Date
  oxcal_data <- parseOxcalOutput(oxcal_read, only.R_Date = FALSE)
  
  # Assemble data frame to be returned
  posterior <- data.frame(
    probabilities = oxcal_data$Sum$posterior_probabilities$probabilities,
    date_grid = oxcal_data$Sum$posterior_probabilities$dates,
    site = data[["site"]][1],
    excavation_project = data[["excavation_project"]][1])
  
  # Return data
  return(posterior)
}

# Apply modelling function to the radiocarbon dates, grouped by site name
posteriors <- radiocarbon %>% 
  group_by(site) %>%
  group_map(~ model_rcarb(.), .keep = TRUE)
  
# The data is returned as a list of lists that needs to be unpacked
rcarb_data <- do.call(rbind, posteriors) 
  
```

The `r nrow(sites)` coastal sites chosen for analysis here have a relatively limited geographical distribution in south-eastern Norway \ref\@(fig:dist)A]. The sites were excavated as part of four larger excavation projects that all took place within the last 15 years [@solheim2013b; @jaksland2014a; @melvold2014b; @reitan2014l; @solheim2017b]. The sites included in the analysis consists of all Mesolithic sites excavated in conjunction with the projects that have assemblages holding more than 100 artefacts. The institution responsible for these excavations was the Museum of Cultural History in Oslo. This has led to a considerable overlap in the archaeological personnel involved, and comparable excavation practices across the excavations. Furthermore, with these projects, major efforts were made to standardise how lithic artefacts were to be classified at the museum. As a result, this should reduce the amount of artificial patterning in the data incurred by discrepancies in the employed systems for categorisation [e.g. @clark2006; @dibble2017]. In this setting, for example, bias could potentially follow from the fact that two of the projects have sites with relatively contemporaneous dates [@solheim2013b; @jaksland2014, see also \ref\@(fig:dist)B]. Any project-dependent classification practice could as a consequence lead to an exaggeration of chronological differences between the assemblages. While this is difficult to fully account for, I do believe that the relative contemporaneity of the excavation projects, as well as the overlap in excavation and classification practices should minimise the above-mentioned effects.

```{r dist, fig.cap = "A) Spatial and B) temporal distribution of the sites chosen for analysis. Radiocarbon probability density functions are given as the posterior sum. Solid lines indicate that the site has been dated with reference to relative sea-level change and typological indicators. These follow the original reports.", fig.height = 10, fig.width = 12}
# Create a bounding box around site points to limit the overview map
sitbbox <- st_bbox(site_pts)
sitbbox[1:2] <- sitbbox[1:2] - 600000
sitbbox[3:4] <- sitbbox[3:4] + 600000
boundingpoly <- st_as_sf(st_as_sfc(sitbbox))

# Reproject the bounding box to match world map, and crop the world map
# with the bounding box polygon
bound_reproj <- st_transform(boundingpoly, st_crs(countries))
mapcountries <- countries %>% 
  filter(st_intersects(., bound_reproj, sparse = FALSE))
count_reproj <- st_transform(mapcountries, st_crs(site_pts))

# Create bounding box around the sites, both for extent indicator on the
# overview map and to create basemap for the site overview.
sitbbox2 <- st_bbox(site_pts)
sitbbox2[1:2] <- sitbbox2[1:2] - 15000
sitbbox2[3:4] <- sitbbox2[3:4] + 15000
boundingpoly2 <- st_as_sf(st_as_sfc(sitbbox2))

# same as above, using the smaller bounding box
bound_reproj2 <- st_transform(boundingpoly2, st_crs(countries))
mapcountries2 <- countries %>% 
  filter(st_intersects(., bound_reproj2, sparse = FALSE))
count_reproj2 <- st_transform(mapcountries2, st_crs(site_pts))

# Assemble overview map
overview <-
  ggplot() +
  geom_sf(data = count_reproj, fill = "grey", colour = NA) +
  geom_sf(data = boundingpoly2,
          fill = NA, colour = "black", size = 1) +
  coord_sf(xlim = c(sitbbox[1], sitbbox[3]), ylim = c(sitbbox[2], sitbbox[4]),
         expand = FALSE) +
  labs(title = "A") +
  theme_bw() + theme(axis.title=element_blank(),
                     axis.text.y = element_blank(),
                     axis.text.x = element_blank(),
                     rect = element_rect(),
                     axis.ticks = element_blank(),
                     panel.grid.major = element_blank()) 

# Combine spatial point data with assemblage data (holds excavation project
# for colouring points in the maps)
sitejoin <- right_join(site_pts, sites, by = c("LOKID" = "askeladden_id"))

# Assemble site map. anc defined first is used for placing the scalebar,
# which required some tweaking to get right.
anc <- as.numeric(c(sitbbox2$ymin, sitbbox2$xmax))
sitemap <-
  ggplot() +
  geom_sf(data = count_reproj2, fill = "grey", colour = NA) +
  geom_sf(data = sitejoin, aes(fill = excavation_project),
          size = 2.25, shape=21, 
          colour = "black") +
  labs(fill = "Excavation project") +
  scale_fill_manual(labels = c("E18 Bommestad-Sky", "E18 Brunlanes",
                               "E18 Rugtvedt-Dørdal", "Vestfoldbaneprosjektet"),
                    values = c("springgreen4", "royalblue2",
                                "gold1", "firebrick3")) +
  ggsn::scalebar(data = site_pts, dist = 10, dist_unit = "km", 
                 transform = FALSE, st.size = 4, height = 0.05, 
                 border.size = 0.05, st.dist = 0.07,
                 anchor = c(x = anc[2] - 8000, y = anc[1]) + 4000) +
  coord_sf(xlim = c(sitbbox2[1], sitbbox2[3]), 
           ylim = c(sitbbox2[2], sitbbox2[4]),
         expand = FALSE) +
 theme_bw() + theme(axis.title=element_blank(),
                     axis.text.y = element_blank(),
                     axis.text.x = element_blank(),
                     rect = element_rect(),
                     axis.ticks = element_blank(),
                     panel.grid.major = element_blank(),
                     legend.position = "none") +
  guides(fill = guide_legend(ncol = 2,
                             title.position = "top", title.hjust = 0.5))

# Combine radiocarbon data and reported (effectively shoreline/typology) dates,
# removing the reported date if there are relevant 14C-dates.
datedata <- full_join(sites, rcarb_data, by = "site") %>% 
  mutate(reported_start_bc = ifelse(dating_method != "c14", reported_start_bc, NA),
         reported_end_bc = ifelse(dating_method != "c14", reported_end_bc, NA))

project_colors <- c("bommestad_sky" = "springgreen4",
                  "brunlanes" = "royalblue2", 
                  "rugtvedt_dordal" = "gold1",
                  "vestfoldbaneprosjektet" = "firebrick3")

# Assemble plot of date ranges
temp_dist <- ggplot(datedata, aes(x = mean_date, y = reorder(site, mean_date))) +
  geom_segment(aes(x = reported_start_bc, xend = reported_end_bc,
                   yend = site, colour = excavation_project.x,
                   fill = excavation_project.x), size = 1.8) +
  geom_ridgeline(aes(x = date_grid * -1, height = probabilities * 150,
                     fill = excavation_project.y, 
                     colour = excavation_project.x)) +
  scale_x_reverse() +
  scale_fill_manual(values = project_colors,
                    labels = c("E18 Bommestad-Sky","E18 Brunlanes",
                            "E18 Rugtvedt-Dørdal", "Vestfoldbaneprosjektet")) +
  scale_colour_manual(values = project_colors) +
  labs(title = "B", fill = "Excavation project") +
  xlab("Cal. BCE") +
  theme_classic() +
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        legend.position = "bottom") +
  guides(fill =  guide_legend(title.position = "top", title.hjust = 0.5),
         colour = FALSE) 


(overview + sitemap) /
(temp_dist + theme(plot.margin = unit(c(0,135,0,135), "pt"))) 

#plot.margin = unit(c(0,135,0,135)
# top right, borrom , l

```

A defining characteristic of the Norwegian Mesolithic is that a clear majority of the known sites are located in coastal areas [@glørstad2010]. Furthermore, these coastal sites appear to predominantly have been located on or close to the contemporary shoreline when they were in use [@breivik2018; @solheim2020]. In south-eastern Norway, this pattern is combined with a continuous regression of the shoreline, following from isostatic rebound [e.g. @sørensen1979; @romundset2018]. The fairly rapid shoreline displacement means that the sites tend not to have retained their strategic or ecologically beneficial shore-bound location for long periods of time [cf. @perreault2019, 47]. Consequently, the shore-bound settlement, combined with the rapid shoreline displacement has resulted in a relatively high degree of spatial separation of cumulative palimpsests, to follow the terminology of @bailey2007, while the reconstruction of the trajectory of relative sea-level change allows for a relatively good chronological control of when these accumulation events occurred. In other parts of the world, a higher degree of spatial distribution means that while the physical separation of material can help delineate discrete events, this typically comes at the cost of loosing temporal resolution as any stratigraphic relationship between the events is lost [@bailey2007]. However, as the rate of isostatic rebound has varied throughout the Mesolithic in the region, and local topography and bathymetry will have impacted how rapidly a site lost its shore-bound location, this effect is not evenly distributed in time and space. In the earliest part of the Mesolithic, the displacement rate within the study area would have been around as much as 8.8 cm/year, falling to around 0.5 cm/year in the Late Mesolithic [@sørensen2014]. Thus, while relative sea-level change appears to have reduced the degree of mixing that has occurred in the assemblages, this could vary depending on when and where they were in use, in turn potentially reducing the degree to which their composition can be directly compared --- a point that is returned to in the discussion of the results.

The data analysed here is based on the classification of the `r nrow(sites)` site assemblages done for the original excavation reports, and consists of `r ncol(select(sites, core:flake_retouch_other))` variables representing different debitage and tool types. While the classification practices for the excavation projects were standardised to an extent, there are some instances where time was allocated to identify additional artefact sub-categories aimed at answering specific research questions. Some categories in the original reports have therefore been combined in the dataset. This for example pertains to the category narrow-blades, which is defined as blades of width between 8 and 12 mm. In the reports, this was only separated from (macro-)blades (width $\ge$ 12 mm) and micro-blades (width $\le$ 8 mm) for some of the sites. Narrow-blades were combined with the blade category here. Furthermore, the artefact data have here been divided into flint and non-flint materials. Flint does not occur indigenously in Norway, and is only available locally as nodules that have been transported and deposited by retreating and drifting ice [e.g. @berg-hansen1999]. This means that the distribution and quality of the flint has been impacted by a diverse set of factors relating to climatic and geographical factors such as, but not limited to, topographic variability, shoreline morphology and ocean currents [@eigeland2015, 46]. An in depth-analysis of the flint quality from sevens sites did result in the finding that the flint quality was relatively high, and consistently so across the sites. However, despite flint being treated as a unified category here, the cited study by was based on only seven sites located some km distance from the present study area, meaning that the results might not necessarily be transferable to the sites treated here [@eigeland2015, 45-53]. Furthermore, the various non-flint raw materials that have been lumped together here can have quite disparate properties, where fine-grained cryptocrystalline materials are often used as a substitute or supplement to flint, while other, coarser materials are usually associated with the production of axes and other macro tools. Given this differentiated use, these raw-material properties are expected to be reflected in the retained debitage and tool categories. An important benefit of combining all of the non-flint materials is that this reduces the dependency on whether or not these have been correctly and consistently categorised for the reports [cf. @frivoll2017]. While certainly a topic deserving of more attention, the general sentiment in the literature is that there would have been stable access to locally available non-flint raw-materials of good quality in south-eastern Norway [@eigeland2015, 370].

Previous studies of lithic artefacts in Norway have typically had a focus on chronological trends associated with formal tool types [e.g. @helskog1976; @reitan2016], involved refit-studies of the entirety of individual assemblages [@skar1986], or been concerned with technological processes associated with certain sub-categories of the site inventories, such as blades or axes [e.g. @damlien2016; @berg-hansen2017; @solheim2020]. Some studies have involved in-depth analyses of handful of sites in terms of intrasite spatial organisation [@nærøy2018], and technological organisation [@eigeland2015; @mansrud2016;]. There are also some more comprehensive evaluations of a larger number of sites with associated lithic assemblages to get at potential site types and related mobility patterns [@breivik2016; @viken2018c; @breivik2020]. However, the narratively driven analyses of these data makes the weighting of different variables unclear, and these studies draw their conclusions based on an arguably over-constraining predefined trichotomy of different site types. Finally, only a single study concerned with eight Middle-Mesolithic sites has employed a multivariate quantitative framework to help structure such a treatment [@solheim2013a]. These sites are also included here. In sum, therefore, previous studies are typically either limited to a small number of sites, to a subset of the inventories, or to more subjectively and narratively driven methods that makes it difficult, if not impossible, to consistently structure and balance the comparison of a larger number of sites with associated assemblages holding lithic artefacts numbering in the thousands.

## Methodology

As the title of the paper suggest, the data has been analysed from an exploratory perspective, meaning that a wide range of methods has been applied. Only parts of this process can sensibly be reported here. The data and R script used for the analysis is freely available as a research compendium following @marwick , allowing readers to explore the data and the analytical choices made [cf. @Marwick2017]. However, this kind of data dredging does arguably not constitute a good foundation for the pursuit of causal relationships, as this process is most certainly impacted by and selectively reported upon, following my own biases. It can, however, result in the identification of interesting relationships that can be subjected to more rigorous testing using different data and approaches in subsequent studies.

The first part of the analysis conducted involves employing the method of correspondence analysis (CA), using the lithic count data as classified for the original excavation reports. The purpose of this exercise is to evaluate the degree to which the composition of the assemblages align with patterns that have been suggested by earlier studies that have employed more informally driven methods. This consequently assumes that the artefact categories employed in Norwegian Stone Age archaeology are, at least to a certain extent, behaviorally meaningful. However, the approach taken is also partially informed by the so-called Frison effect [@jelinek1976], which pertains to the fact that lithics studied by archaeologists can have had long and complex use-lives in which they took on a multitude of different shapes before they were ultimately discarded. Several scholars have built on this to argue that morphological variation in retouched lithics cannot be assumed to predominantly be the result of the intention of the original knapper to reach some desired end-product, but rather that what is commonly categorised as discrete types of artefacts by archaeologists can instead in large part be related to variable degrees of modification through use and rejuvenation [e.g. @barton1991; @dibble1995]. Consequently, several artefact categories have here been collapased for the CA. This for example pertains to tool types such as scrapers, burins, drills, knives and otherwise indeterminate artefacts with retouch. That these categories are internally consistent and categorically exclusive in terms of fulfilled purpose is at best a dubious proposition, in turn potentially rendering their contribution as discrete analytic units misleading. These have all been combined into the single category "small flint tools". (A full overview of the aggregated variables and their constituent parts is provided in the supplementary material). While aggregating artefact categories in this manner could potentially subsume important variation, it does also reduce the possibility that any conclusions are not simply the result of employing erroneous units of analysis. An underlying assumption is therefore that the retained categories represent artefact categories that have fulfilled different purposes or are related to different technological processes. While ultimately intuitive in nature, it does seem reasonable to assume that for example large non-flint stone tools such as axes, adzes, chisels, clubs and hatches, here categorised as non-flint macro tools, have fulfilled different purposes than the previously mentioned small flint tools.

However, for the most part we lack even a most basic understanding of what any individual lithic object has been used for [@dibble2017]. This has major implications that the above-outlined analysis does not take properly into account, rendering it difficult to align any identified pattern with specific behavioural dimensions. For example, a vast amount of artefacts defined as debitage are likely to have fulfilled the function of tools, and both debitage and formal tool types could have had various different purposes and had a multitude of shapes throughout their use-life. While use-wear analysis could potentially offer a way to identify what artefacts were used for towards the end of their use-life, these kinds of analyses are extremely time-consuming and are therefore typically only conducted on a smaller number of artefacts that have already been selected for analysis based on their shape [e.g. @solheim2018]. Thus, while these analyses can potentially get at in-group variation pertaining to the end-state of a group of artefacts, they do not tell us whether or not their classification as a unified group is meaningful in the first place [@dibble2017]. As a consequence, the second part of the analysis employs a suite of measures developed for the classification of lithic assemblages developed with these inferential limitations in mind [see @clark2017, and below]. The logic behind these measures are founded on an understanding of technology as being organised along a continuum ranging between curated and expedient [@binford1979]. An expedient technological organisation pertains to the situational production of tools to meet immediate needs, with little investment of time and resources in modification and rejuvination, resulting in high rates of tool replacement. Curated technological organisation, on the other hand, has been defined as related to manufacture and maintenance of tools in anticipation of future use, the transport of these artefacts between places of use, and the modification and rejuvenation of artefacts for different and changing situations [@binford1979].

However, following not least from the ambiguous definition first put forward by @binford1979, the theoretical definition of curation, its archaeological correlates, and behavioural implications have been widely discussed, and no single definition has ever been reached [e.g. @bamforth1986; @shott1996; @surovell2009, 9--13]. The continuum between curated and expedient technology has for example been related to dimensions such as land-use and mobility strategies, as well as raw-material quality and availability [e.g. @parry1987; @kuhn1992; @andrefsky1994; @smith2015; @clark2017]. Still, that the distinction can offer a useful analytical framework if clearly operationalised seems more or less agreed upon, and some dimensions of the concept are generally accepted. For example, although precisely how it is measured may vary, the empirical correspondent to a curated technological organisation is typically defined by high degrees of retouch, as this is commonly seen as a means of realising the potential utility of a tool --- or extending its use-life --- by the repeated rejuvenation and modification of edges [e.g. @bamforth1986; @dibble1995; @shott2005]. Furthermore, one concrete operationalisation of the terms have been forwarded by Barton and collegues [e.g. -@barton1999; @barton2014; @clark2017], who through a series of studies have shown that the relationship between volumetric density of lithics and relative frequency of retouched artefacts in lithic assemblages provide consistent results across a wide range of chronological and cultural context, and is a measure taken to reflect degree of curation. This is in turn mainly to follow from the accumulated nature of the land-use and mobility patterns associated with the sites [@barton2014]. In this model, higher degree of mobility would mean a higher dependency on the artefacts and the material people could bring with them, and dimensions such as weight, reliabilty, repairability, and the degree to which artefacts could be manipulated to fulfill a wide range of tasks are therefore assumed to have been factors of concern. From this it follows that the empirical expectation for short-term camps is a curated technological organisation with higher relative frequency of retouched artefacts, and a lower overall density of lithics [@clark2017]. More time spent in a single location, on the other hand, is assumed to lead to better control of raw-material availability and to allow for its accumulation. This should in turn lead to an expedient technological organisation with reduced necessity for the conservation of lithics and extensive use of retouch. The empirical expectation for lower degree of mobility is therefore relatively high density of lithics, a low relative frequency of retouched artefacts, as well as a higher number of cores and unretouched flakes and blades [@clark2017].

These are the main measure employed here. However, as these measures are argued to predominantly be determined by mobility patterns, some additional variables suggested by @Bicho2020 to be related to mobility patterns are also explored. This is done using principal components analysis (PCA), following the continuous operationalisations of these measures [cf. @baxter1994, 100].

A note should also be made on the fact that a couple of variables that are sometimes invoked for the classification of sites in terms of associated mobility pattern are omitted here. This pertains to number of site features such as fireplaces, cooking pits and dwelling structures. Feature count has been omitted as taphonomic loss is likely to have led to a chronological bias in their preservation. Similarly, the number of activity areas, effectively number artefact clusters, however defined, has also been disregarded. This follows most notably from the fact that the impact of post-depositional processes at Stone Age sites in Norway is arguably understudied. This pertains for example to the impact of bioturbation in the form of three-throws, which can can have a detrimental effect on the original distribution of artefacts, and which can be expected to have been relatively frequent on several of the sites treated here [@jørgensen2017; @darmark2018e].

Here retouch i At logistical basecamps, the extended time spent in a single location would imply a better control of raw material availability, and allow for longer trips to retrieve these. Higher availability of lithic raw materials should in turn reduce the necessity for extensive retouch, meaning the material expectation for logistical basecamps would be relatively high density of lithics and a low relative frequency of retouched artefacts. From this it follows that the empirical expectation for short-term camps is a higher relative frequency of retouched artefacts, and a lower overall density of lithics [@clark2017].

# Theory/calculation

Higher frequency of secondarily worked lithics

# Results

```{r lithics}
lithics <- sites %>%
  # Combine flint projectiles into a single variable
  mutate(
    projectile = microlith + tanged_point + transverse_point + 
    single_edged_point + hognipen_point + projectile_undefined,
    small_tool = scraper + knife + burin + drill + blade_retouch + 
      microblade_retouch + chip_retouch + fragment_retouch + flake_retouch,
    macro_tool = axe + chisel, 
    macro_tool_other = axe_other + chisel_other + club_hatchet_other,
    small_tool_other = knife_other + scraper_other + drill_other + 
      microblade_retouch_other + blade_retouch_other + fragment_retouch_other +
      flake_retouch_other,
    .keep = "unused") %>%
  # Make site names the rownames
  column_to_rownames(var = "site") %>% 
  # Deselect a few of the columns not be used
  select(-n, -excavation_project, -excavated_m3, -dating_method)
```

```{r co_data}
# Perform correspondence analysis on the data. 'mean_age' is meant for colouring
# so is excluded here
calithics <- CA(select(lithics, -mean_date, -artefact_count, -flint_count, 
                       -nonflint_count, -reported_start_bc, -reported_end_bc,
                       -askeladden_id),
                graph = FALSE)

# Retrieve eigenvalues
eigval <- get_eigenvalue(calithics)
explained_cumul_dim2 <- eigval[2,3]

# Find date to hold the central tendency date
centdate <- (sum(range(lithics$mean_date)) / 2) / 1000
```

```{r cor1, fig.cap = "Correspondence analysis using artefact count data.", fig.height = 8, fig.width = 10, eval = FALSE}
# Plot with site names tags (probably most immediately relevant for an audience 
# familiar with the sites)
fviz_ca_row(calithics, col.row = "black", fill = lithics$mean_date / 1000, title = "A",
                     repel = TRUE, shape = 21, pointsize = 2.9) +
  scale_fill_gradient2(name = "ka BP", low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 
```

```{r cor, fig.cap = "Correspondence analysis using artefact count data. A) Object map, B) Variable map.", fig.height = 13}
# Plot without site names tags
plt1 <- fviz_ca_row(calithics, geom = "point", col.row = "black", fill = lithics$mean_date / 1000, title = "A",
                     repel = TRUE, shape = 21, pointsize = 2.9) +
  scale_fill_gradient2(name = "ka BP", low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 
#guide(fill = guide_legend(reverse = TRUE)) # Reverses the legend but makes it
                                            # discrete

# Plot variables
plt2 <- fviz_ca_col(calithics, col.col = "black", repel = TRUE, title = "B") 

plt1 /
plt2

```

Figure \@ref(fig:cor) displays the CA using the lithic count data. The general impression from the plots is that a chronological dimension is associated with the patterning in the data. This is indicated by the general transition across the colour scale in the row plot (Figure \@ref(fig:cor)A), combined with the fact that the two first dimensions of the CA accounts for as much as `r round(explained_cumul_dim2, 2)` % of the inertia or variance in the data. The earliest sites tend to be located in the upper right corner of plot A, with increasingly younger sites towards the bottom along the second dimension. Although fewer in number, the sites from the later parts of the Mesolithic are drawn out along the first dimension of the plot, and are not as impacted by the second dimension as the more numerous older sites.

The column plot (Figure \@ref(fig:cor)B) reveals that the earliest sites are characterised by the flint artefact categories microburins, projectiles, as well as flint macro tools and associated debitage. It is also interesting that these sites to larger extent are characerised by core fragments, both in flint and non-flint materials, than cores themselves. The non-flint material on the earliest sites appears to be centered around the production of projectiles, as both the projectiles themselves and non-flint blades are important constituents of the assemblages at these sites. These findings are in large part in line with previous research [e.g. @bang-andersen2003], although possibly highlighting the importance of the non-flint materials to a larger extent than what has traditionally been the case.

The first dimension, which is pulling some of the later sites towards the right of the plot, is mainly defined by macro tools and associated debitage in non-flint materials that are negatively correlated with more flint dominated assemblages and non-flint projectiles. While the outer end of the first dimensions is dominated by later Mesolithic sites associated with axe production in non-flint materials, the later sites occur along the entire dimension, indicating that while these axe production sites are a feature of the later Mesolithic, there is marked variation among these later sites. Although the sample size is quite strained and the discussion of finer chronological points might not be warranted, the first dimension does appear to be of of less importance for the absolute latest sites, as indicated by their location to the left of the plot. This could indicate that specialised axe production sites disappear towards the end of the Mesolithic, a notion that would be in line with previous research [e.g. @eigeland2015, 370, @glørstad2011].

In addition, Nedre Hobekk 2 represents a somewhat curious case in that its assemblage is dominated by axe production in metarhyolite. The use of metarhyolite is typically seen as a feature of the end of the EM and the MM, but is evidently not as prominent a part of other sites that are contemporaneous with Nedre Hobekk 2.

# 

Reducing the number of such inferential leaps by aggregating artefact groups could potentially subsume important variation, but it does also reduce the possibility that the conclusions of any analysis is not simply the result of the employed units of analysis, and an overly naive trust in the fact that these units reflect any behaviourally meaningful categories. This realisation has led to a wide range of outside Scandinavian Mesolithic research, meaning a range of empirical measures associated with various mobility patterns are available.

It has, however, been suggested that access to raw-materials can be a more important decider for assemblage composition than mobility patterns , and that variable workability of these materials will impact factors such as the relative frequency of tools to debitage in the assemblages [e.g. @andrefsky1994; @manninen2014]. In addition to attempts at accounting for this analytically (see below), the limited geographical distribution of the sites should alleviate the issue somewhat, as the overall availability of raw materials could be expected to be more comparable through time than if a wider region was under consideration.

Of these the most well-estbalished is the. base don the assumption that, this measure and has been shown to display a meaningful measure across a wide range of temporal, geographical and cultural contexts.

```{r pcadata}
# Tried to do this to avoid having to type the variable names into both mutate()
# and select(). The general syntax select(-(vector_of_variable_names)) worked,
# but not: mutate(new_varaible = sum(vector_of_variable_names) / artefact_count)
blanks_flint <- c("blade", "microblade", "fragment", "flake")

blanks_lithics <- c(blanks_flint, "flake_other", "fragment_other", 
                     "blade_other",  "microblade_other")

secondary_flint <- c("axe_debitage", "axe", "chisel", "microlith", 
                    "tanged_point", "transverse_point", "single_edged_point",
                    "hognipen_point", "projectile_undefined", "microburin",
                    "scraper", "knife", "burin", "drill", "blade_retouch",
                    "microblade_retouch", "chip_retouch", "fragment_retouch",
                    "flake_retouch")

secondary_lithics <- c(secondary_flint, "axe_other", "axe_debitage_other",
                       "chisel_other", "club_hatchet_other", 
                       "grinding_slab_stone", "projectile_point_other", 
                       "knife_other", "scraper_other", "drill_other", 
                       "microblade_retouch_other", "blade_retouch_other",
                       "fragment_retouch_other", "flake_retouch_other")

lithics2 <- sites %>% 
  select(-n, -beach_flint_flint_nodule, -hammerstone, -excavation_project,
          -askeladden_id) %>% 
  # The reason for not using .keep below is for the option to 
  #retain artefact_count
  mutate(chip_freq =  sum(chip, chip_other) / artefact_count,
         core_freq = sum(core, core_other) / artefact_count,
         blanks_freq = sum(blade, microblade, flake, flake_other, fragment,
                           fragment_other, blade_other,  microblade_other) / artefact_count,
         secondary_freq =  sum(axe_debitage, axe, chisel, 
                microlith, tanged_point, transverse_point, single_edged_point,
                hognipen_point, projectile_undefined, microburin, scraper, 
                knife, burin, drill, blade_retouch, microblade_retouch, 
                chip_retouch, fragment_retouch, flake_retouch, axe_other,
                axe_debitage_other, chisel_other, club_hatchet_other, 
                grinding_slab_stone, projectile_point_other, knife_other,
                scraper_other, drill_other, microblade_retouch_other, 
                blade_retouch_other, fragment_retouch_other,
                flake_retouch_other) / artefact_count,
         lithic_dens = artefact_count / excavated_m3) %>%
  select(-blanks_lithics, -secondary_lithics, -excavated_m3, -artefact_count,
         -flint_count, -nonflint_count, -core, -core_fragment, -chip, 
         -chip_other, -core_other, -core_fragment_other) %>% 
  column_to_rownames("site")


# Repeat but for flint only
flint2 <- sites %>% 
  select(-n, -beach_flint_flint_nodule, -hammerstone, -excavation_project, 
         -reported_start_bc, -reported_end_bc, -askeladden_id) %>% 
  select(!ends_with("other")) %>% 
  mutate(chip_freq =  sum(chip) / artefact_count,
         core_freq = sum(core) / artefact_count,
         blanks_freq = sum(blade, microblade, flake, fragment) / artefact_count,
         secondary_freq =  sum(axe_debitage, axe, chisel, 
                microlith, tanged_point, transverse_point, single_edged_point,
                hognipen_point, projectile_undefined, microburin, scraper, 
                knife, burin, drill, blade_retouch, microblade_retouch, 
                chip_retouch, fragment_retouch, flake_retouch) / artefact_count,
         flint_dens = flint_count / excavated_m3) %>%
  select(-blanks_flint, -secondary_flint, -excavated_m3, -artefact_count,
         -flint_count, -nonflint_count, -grinding_slab_stone, -core, 
         -core_fragment, -chip, dating_method) %>% 
  column_to_rownames("site")

wabicor <- cor(log10(lithics2$lithic_dens), log10(lithics2$secondary_freq))
wabicorflint <- cor(log10(flint2$flint_dens), log10(flint2$secondary_freq))
```

```{r cor-plot, fig.cap = "Correlation plot showing transformation of skewed variables for the PCA, and the linear correlation between these", fig.height = 9.5, fig.width = 10}
# Transform the skewed variables - sqrt() is used where there are zero values,
# and seems to provide an adequate result.
lithicstr <- lithics2 %>%
  # Transform skewed variables and reorder
  mutate("Mean date cal. BCE*-1" = mean_date * -1,
          "log10(lithic_dens)" = log10(lithic_dens),
         "log10(secondary_freq)" = log10(secondary_freq),
         "core_freq^(1/3)" = core_freq^(1/3), .keep = "unused") %>% 
  relocate("Mean date cal. BCE*-1",
    "log10(lithic_dens)", "blanks_freq", "log10(secondary_freq)",
    "chip_freq", "core_freq^(1/3)" 
  )

corr_plot(select(lithicstr, -reported_start_bc, -reported_end_bc, -dating_method))
```

```{r pca-analysis, fig.cap = "PCA using variables related. Note that details on the transformation of the variables has been left out of the plot for clarity.", fig.height = 7, fig.width = 10}
# Rename the transformed variables again to avoid clutter in the plot. 
# Specify in figure caption that the transformed variables are used 
lithicspca <- lithicstr %>% 
  mutate(mean_date =  `Mean date cal. BCE*-1` * -1, .keep = "unused") %>% 
  rename(
   lithic_dens = "log10(lithic_dens)",
   secondary_freq = "log10(secondary_freq)",
   core_freq = "core_freq^(1/3)"
  )


pcalithics <- PCA(select(lithicspca, -reported_start_bc, -dating_method,
                         -reported_end_bc, -mean_date),
                  scale.unit = TRUE, graph = FALSE)
fviz_pca(pcalithics, geom.ind = "point", fill.ind = lithicspca$mean_date / 1000, 
          repel = TRUE, col.var = "black", pointshape = 21,  pointsize = 2.9,
         title = "") + 
  scale_fill_gradient2(name = "ka BP",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 

```

Figure \@ref(fig:pca-analysis) displays a principle components analysis using variations of the continuous measures for mobility patterns as operationalised by @clark2017 and @Bicho2020. There is a general temporal transition from older to younger sites along the second dimension of the plot, which is mainly defined by a negative correlation between the variables volumetric density of lithics and relative frequency of secondarily worked lithics, as well as relative frequency of cores. Almost orthogonal to this is the negative correlation between relative frequency of chips and blanks. While there is perhaps a slight tendency for blanks to be more associated with younger sites, and chips with older sites, this relationship does in large part appear to be temporally determined. The investigation performed by @Bicho2020 indicated that in their data the relative frequency of chips, cores, and blanks might be more sensitive to mobility patterns. However, they also found that the relationship between volumetric density of lithics and the frequency of retouched artefacts gave a reasonable estimation of mobility, which, combined with the fact that the relative frequency of cores align with the expectation from the @clark2017 model, would indicate that this relationship is capturing the dimensions of interest here. If the relationship between frequency of secondarily worked artefacts and volumetric density of lithics is accepted as a proxy for curation, and in turn related to land-use and mobility patterns, these findings would be in line with previous research into the Mesolithic of Norway, indicating that earlier sites are associated with higher degree of mobility than sites from later phases. To explore this proposition further, these two variables are subjected to more detailed scrutiny below.

```{r eigenvalues, fig.cap = "Table showing the eigenvalues of the components."}
# Create a table showing the eigenvalues of the components
round(as_tibble(get_eig(pcalithics)), 2) %>% 
  rename("Eigenvalue" = eigenvalue, "Variance (%)" = variance.percent, 
         "Cumulative variance (%)" = cumulative.variance.percent) %>% 
  rownames_to_column(var = "Component") %>% 
gt(rowname_col = "row", auto_align = FALSE)
```

```{r var_contrib, fig.cap = "Contribution of variables to components.", fig.height = 3}
# The plots below investigates the contribution of the variables to the
# components. The code has in large part been taken from 
# Bicho & Cascalheira (2020).
var <- get_pca_var(pcalithics)
dim1 <- fviz_contrib(pcalithics, choice = "var", axes = 1,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 1")
dim2 <- fviz_contrib(pcalithics, choice = "var", axes = 2, 
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 2")
dim3 <- fviz_contrib(pcalithics, choice = "var", axes = 3,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 3")
dim4 <- fviz_contrib(pcalithics, choice = "var", axes = 4,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 4")

# Patchwork for arranging plots
(dim1 | dim2) 
#(dim3 | dim4)
```

```{r var_cor, fig.cap = "Plots showing the correlation between the variables", eval = FALSE}
plt1 <- fviz_pca_var(pcalithics,
                  col.var = "black",
                  title = "Correlation plot: Component 1/Component 2",
                  repel = TRUE
                  )
plt2 <- fviz_pca_var(pcalithics,
                  col.var = "black",
                  axes = 3:4,
                  title = "Correlation plot: Component 3/Component 4",
                  repel = TRUE
                  )

plt1 + plt2
```

Figure \@ref(fig:wabi) displays the WABI as found for the site data. This indicates a negative correlation between the two variables (r = `r round(wabicor, 2)`) and a general tendency for younger sites to be associated with a higher volumetric density of lithics and a lower relative frequency of secondarily worked lithics than older sites. Following @clark2017, this would be in line with a general transition from a expedient to curated lithic technology. Variable raw-material availability can also impact these measures as [@manninen2014]. Variation in raw-material use over time could consequently mean that these patterns could be an effect of the available raw material rather than mobility strategies. However, as is evident in when considering both plots in \@ref(fig:wabi), the pattern is evident for both the lithics considered in aggregate and for the flint data specifically. Although the distribution is slightly more spread out along the y-axis than the x-axis in the flint data, indicating that differences in volumtric density of flint is not as clearly contingent on chronology, the general pattern is the same.

To visualise this temporal trend more clearly, a curation index based on the two variables was devised by first performing a min-max normalisation of the two variables, scaling them to take on values between 0 and 1. The values for artefact density was then made negative to reflect its relationship with degree of curation. The mean was then found for each site on these two normalised values. To account for the temporal uncertainty associated with the sites, a simulation-based approach was also adopted [e.g. @crema2012; @baxter2016; @orton2017]. A LOESS curve was fit to the data for each simulation run, where the age of each site was drawn from the date ranges associated with the sites. For sites with radiocarbon age determinations the dates were drawn from the associated posterior probability density functions, while dates for sites dated with reference to relative sea-level change and typology were drawn uniformly from the associated date range. This simulation was repeated 1000 times, the results of which is visualed in . Disregarding the edge-effects at either end of the plot, the general tendency is a relatively high degree of curation among the earlier sites, followed by a marked drop around 8000 BCE, before remaining relatively stable until the end of the Mesolithic. It is also interesting to note that the variation in degree of curation is higher after 8000 BCE, potentially reflecting variation in site types and associated mobility patterns.

```{r wabi, fig.cap = "Relative frequency of secondarily worked lithics plotted against the volumetric density of artefacts (artefact count / excavated m^3^) for A) All lithics, B) Flint. The logarithm is taken to base 10 on all axes.", fig.height = 5, fig.width = 10}
w1 <- ggplot(lithics2, aes(lithic_dens, secondary_freq * 100, 
                     fill = mean_date / 1000)) + 
  geom_point(shape = 21, size = 3) +
  geom_smooth(method = "lm", col = "black", se = FALSE) +
  labs(title = "A",
       x = "Volumetric density of lithics (log10)", 
       y = "Relative frequency of secondarily worked lithics (log10)") +
  scale_fill_gradient2(name = "ka BP",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  scale_y_log10() +
  scale_x_log10() +
  theme_classic()

w2 <- ggplot(flint2, aes(flint_dens, secondary_freq * 100, 
                     fill = mean_date / 1000)) + 
  geom_point(shape = 21, size = 3) +
  geom_smooth(method = "lm", col = "black", se = FALSE) +
  labs(title = "B", 
       x = "Volumetric density of flint (log10)", 
       y = "Relative frequency of secondarily worked flint (log10)") +
  scale_fill_gradient2(name = "ka BP",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  scale_y_log10() +
  scale_x_log10() +
  theme_classic()



w1 | w2
```

```{r index}
# Create curation index
minmax <- lithics2 %>% 
   rownames_to_column(var = "site") %>% 
  mutate(dens =  ((lithic_dens - min(lithic_dens)) / (max(lithic_dens) - min(lithic_dens))),
         secondary = ((secondary_freq - min(secondary_freq)) / (max(secondary_freq) - min(secondary_freq))))

indexdata <- minmax %>% 
  rowwise() %>% 
  mutate(index = mean(c(dens * -1, secondary)))

# Curation index plot simply using mean site age (not used)
w3 <- ggplot(indexdata, aes(x = mean_date, y = index)) + 
  geom_point() +
  labs(title = "C",
       x = "Mean date cal. BCE",
       y = "Curation index") +
  scale_x_reverse() + 
  geom_smooth(method = "loess", col = "red") +
  theme_classic()  + 
  ggrepel::geom_label_repel(aes(label = site),box.padding   = 0.35, 
                  point.padding = 0.5,
                  segment.color = 'grey50') 
#w3
```

```{r simage, cache = TRUE, fig.cap = "Temporal variation in the curation index. The temporal uncertainty is handled by means of a simulation approach, where the site ages are drawn from their associated probability distributions given in Figure 1B. A LOESS curve has been fit to the distribution for each of the 1000 simulation runs."}

agedata <- full_join(indexdata, rcarb_data, by = "site") 

# Define function to draw sample from either 14C probability distribution,
# or uniform typological/displacement-inferred date range.
sample_date <- function(site){
  
  # If the dating method is 14C, draw a sample using the associated posterior
  # pdf
  if(site["dating_method"][1,] == "c14"){
    samplingframe <- list(x = site[["date_grid"]], y = site[["probabilities"]])
    sdate <- with(samplingframe, sample(x, size = 1, prob = y))
  # If not, draw a random year from the reported date range (uniform probability)
  } else {
    sdate <- sample(as.integer(site["reported_start_bc"]*-1):as.integer(site["reported_end_bc"]*-1), 1)
  }
  # Return sampled date with site name as rowname. 
  sdate <- data.frame(sdate)
  row.names(sdate) <- site[["site"]][1]
  return(sdate)
}

# Specify number of simulations
nsim <- 1000

# Create data frame to hold simulation results.
results <- data.frame(matrix(NA, ncol = nsim, nrow = nrow(sites))) 
# Insert the curation index value for each site
results[,"index"] <- agedata %>% 
  group_by(site) %>% 
  slice(1) %>% 
  ungroup() %>% 
  select(index) %>% 
  c()

# Simulation loop
for (i in 1:nsim){
  agesamples <- agedata %>% 
    group_by(site) %>% 
    group_map(~ sample_date(.), .keep = TRUE) %>% 
    do.call(rbind, .)
  
  results[,i] <- agesamples
  row.names(results) <- row.names(agesamples)
}

# Apply pivot_longer to make the results amenable to plotting
resultslong <- results %>% 
  rownames_to_column(var = "site") %>% 
  pivot_longer(
    cols = starts_with("X"),
    names_to = "sim", 
    values_to = "age"
  )

# Call to plot, grouping loess fits by simulation runs
ggplot(resultslong, aes(x = age, y = index)) + 
  geom_smooth(aes(group = sim), method = "loess", fill = "grey", col = "black", alpha = 0.05, se = TRUE) +
  geom_point(size = 0.5, alpha = 0.005) +
  xlab("Cal. BCE") +
  ylab("Curation index") +
  theme_classic()

```

# Discussion

The results of the CA does appear to align reasonably well with previous research that has been based on more informal analyses of artefact types, indicating that the employed artefact categories are capturing some behaviorally meaningful patterning that changes over time. However, as several authors have pointed out in relation to the application of CA for seriation purposes, 'time is not the only dimension'. The developments evident here do also most certainly correspond to more pervasive cultural change than a purely typo-chronological development of artefact morphology, highlighted perhaps most clearly by the influence of the later Mesolithic axe production sites. Unpicking and aligning the significance of these chronological patterns with any specific behavioural dimensions using the CA results is, however, another task entirely. This follows most clearly from the fact that for the most part we do not know what individual lithic objects in the assemblages has been used for, leaving the behavioural significance of the employed units of analysis unclear.

Assuming for now that the curation index captures degree of mobility, the present data indicates two major modes with a generally higher degree of mobility until some time before 8000 BCE. This then drops and stabilises from around 7000 BCE for the rest of the Mesolithic. The variation in degree of curation, which, as a note, is at it highest between c. 8000 and 7000 BCE, could indicate that the sites were associated with a more varied mobility pattern after around 8000 BCE. The five sites that have values on the curation index below -0.25, could in this perspective have predominantly functioned as base camps within a logistic settlement pattern. That these assemblages reflect stays of a longer duration was suggested for all five sites in the original reports, although on different and differing grounds than the curation measures employed here. Another case worth commenting on is sites such as Langangen Vestgård 1, which on the grounds of a large number of artefacts and the possibile presence of a dwelling structure was argued to reflect a more stable site location in the original report. However, the site could reflect the aggregation of stays which predominantly have been of shorter duration, while the possible dwelling structure, if taken as an indication of lower mobility, could represent a remnant from one or a few longer stays that constitute a smaller fraction of the use-life of the site as a whole. It is also interesting to note that some of the chronological patterns indicated in the CA does not appear to be related to the curation measures. This for example pertains to the apparent importance of the axe production sites. It has recently been suggested that the end of the Mesolithic sees a drop in population numbers and a subsequent increase in mobility as migrating populations arrived from southern Scandinavia. Whether the apparent absence of this pattern in the present data is a result of a strained sample size or a weaker or non-existent signal from any changes in mobility patterns in the later Mesolithic remains an open question. As it stands, however, the main hypothesis generated by the present data would be that settlement patterns in the earliest parts of the Mesolithic were characterised by relatively high degrees of mobility, which then drop before leveling off at around 7000 BCE and remain relatively stable throughout the rest of the period. Given the parallel increase in variation this would seem to correlate well with a transition from a residential to a logistical settlement system.

As for the measures associated with curation and mobility patterns, relative frequency of secondarily worked lithics and volumentric density of lithics correspond most clearly to patterns previously proposed in the literature. However, as these were identified by employing PCA and identifying what variables most clearly correspond to a temporal dimension, there is a clear danger of circular reasoning here. Having established that these measures appears to capture a behavioural dimension of interest, this can, however, now be tested more rigorously by employing site data from a wider region. these results do speak to the cross-cultural and cross-temporal applicability of the measure, and consequently the potential it holds for comparative studies. The findings indicated by the WABI, as well as by the negative correlation between relative frequency of primarily and secondarily worked lithics, do align more clearly with previous suggestions concerning the overall mobility patterns in Mesolithic Norway. However, the question then becomes: What is the significance of the negatively correlated variables of relative frequency of cores and chips? Given that these are more or less orthogonal to the WABI variables on the first and second component, this would indicate that if one of these variable pairs is taken to reflect the scale between expedient and curated technologies, it should follow that the other variable pair is not correlated with these. As the entire temporal range of the sites is spread out between the extremes of the chip and core variables, one possibility is that these are indicative of site types that are temporally ubiquitous.

This is arguably more established than the variables included bysimilarities between the variable plots of @Bicho2020 and the variables indicated in is striking. This pertains to the negative correlation between core and chip frequency, and the negative correlation between primary and secondarily worked lithics. This last

These measures are taken from the framework of whole assemblage behavioural index, as developed by , and is aimed to get at behavioural dimensions relating to mobility patterns among hunter-gatherers.

# Conclusion

The results of the CA using the entirety of the lithic assemblages align more or less with results of previous research in south-eastern Norway. This would indicate that in general, meaningful chronological patterning is associated with the employed artefact categories. These tendencies are already well-established when it comes to the formal tool types, but have been given less focus in light of entire assemblages. these notions have previously Precisely what behavioural implication the development in the use of these types have, however, is unclear, but appears to follow a different and more complex trajectory than that of curation, as measured here.

The results of considering variables that are have been associated with mobility patterns gave rise to two competing hypotheses. These pertain to whether the degree of curation associated with the assemblages as captured by the changing ratio of primary to secondarily worked lithics over time is the result of changing raw material availability or mobility patterns. The orthogonal relationship between core to chip frequency would in this framework be expected to be capturing the opposite relationship. If degree of curation mainly reflects changes in raw-material quality and availability, this would then indicate that mobility patterns are comparable throughout the Mesolithic as the core to chip frequency is not time-dependent. And vice verca --- if the changing mobility patterns is the main driver of the transition from curated to expedient technological organisation, as operationalised here, While this would be in line with findings from a recent evaluation of the locational patterns associated with the sites [@roalkvam2020], there is no readily available empirical evidence, no smoking gun, se findings are the results of an exploratory analysis, and are therefore perhaps best seen as potentially laying the framework for later targeted strategic test of these competing hypotheses.

<!-- The following line inserts a page break  -->

\newpage

# References

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

::: {#refs}
:::

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies:

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
