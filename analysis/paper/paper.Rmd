---
title: "Exploring the composition of lithic assemblages in Mesolithic south-eastern Norway"
author:
  - Isak Roalkvam:
      email: isak.roalkvam@iakh.uio.no
      institute: [UiO]
      correspondence: true
institute:
  - UiO: University of Oslo
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::html_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style
---

<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

<!-- The following code chunk defines some general settings how code chunks should behave. -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.width = 9,
  fig.path = "../figures/",
  dpi = 300
)
```

```{r libraries, eval = TRUE}
library(tidyverse)
library(GGally)
library(patchwork)
library(gt)
library(FactoMineR)
library(factoextra)
library(sf)
library(rnaturalearth)
library(oxcAAR)
quickSetupOxcal()
```

```{r get-functions, include = FALSE}
source(here::here("analysis/script/plot_functions.R"), local = knitr::knit_global())

#setOxcalExecutablePath("/tmp/RtmpFVOcBJ")
```

```{r get-data, eval = TRUE, results = 'hide'}
assemblages <- read.csv(here::here('analysis/data/raw_data/assemblage_data.csv'))
radiocarbon <- read.csv(here::here('analysis/data/raw_data/radiocarbon_data.csv'))
site_pts <- st_read(here::here('analysis/data/raw_data/sites.gpkg'))

# ne_download() is currently failing
#countries <- ne_download(scale = 10, type = 'countries', category = 'physical',
#                         returnclass = "sf")
countries <- st_read(here::here('analysis/data/raw_data/naturalearth_countries.gpkg'))

# gis <- read.csv(here::here('../../site_data.csv'))
# gis$askeladden_id <- as.integer(str_replace_all(gis$askeladden_id, c("-1" = "", "-0" = "", "-2" = "", "-3" = "", "-4" = "")))
# gisjoin <- right_join(gis, sites, by = c("askeladden_id" = "askeladden_id"))
```

# Introduction

The analyses conducted here employs multivariate exploratory statistics using the entirety of the lithic assemblages associated with a larger number of Mesolithic sites located in south-eastern Norway. This is done to identify latent patterns and structure in the relationship between the assemblages, with the ultimate aim of identifying behaviourally induced variation in their composition across time and space. However, the composition of the assemblages can be expected to be determined by a multitude of factors [e.g. @dibble2017], ranging from the impact of natural formation processes, to various and intermixed behavioural aspects such as purpose, duration, frequency and group sizes at visits to the sites. The assemblages are also likely to be impacted by variation in lithic technology, artefact function, use-life and discard patterns, as well as access to raw materials and seasonality. Finally, analytical and methodological dimensions relating to survey, excavation and classification practices are also fundamental to how the assemblages are defined. Consequently, the analysis conducted here is done from an exploratory perspective, where all of these factors should be seen as potential contributors to any observed pattern.

Even though each individual assemblage can have been impacted by an infinitude of effects that might skew an archaeological interpretation, this does not preclude the applicability of inductive analyses aimed at revealing overarching structure in the data, without imposing overly complex analytical frameworks that attempt to account for these particularities [@bevan2015]. Structure that can be revealed from considering all of the assemblages in aggregate can constitute a step in an iterative analytical chain that ultimately aims to tease apart such aspects from the multitude of factors that have shaped the composition of the assemblages, and should be of value to subsequent in-depth studies of any individual site. The most immediate danger of the approach outlined here is rather to be overly naive in the causal significance and cultural importance that is ascribed to any identified pattern. As such, the main aim of this analysis is to compare the results with findings reported in previous literature concerned with the Mesolithic in southern Norway, that are typically based on more informally driven methods, and have the generation of new hypotheses as a possible outcome. To this end, the analysis follows two analytical avenues. The first involves an analysis of the assemblages that is based on the classification of the artefacts done for the original excavation reports. The second involves an analysis of the assemblages in light of the whole assemblage behaviour index, which has not seen application in this context before.

## Archaeological context and material

```{r wrangling}
sites <- assemblages %>% 
      # Find mean reported date for each site (to be used in the plots below)
  rowwise() %>% 
  mutate(mean_date = mean(c(reported_start_bp, reported_end_bp))) %>% 
  mutate(
    # Find total artefact count and flint count for each site
    artefact_count = sum(c_across(core:flake_retouch_other)),
    flint_count = sum(c_across(core:flake_retouch)),
    nonflint_count = sum(c_across(axe_other:flake_retouch_other))) %>%
  # Exclude sites with less than 100 artefacts
  filter(artefact_count > 100)

h3 <- radiocarbon %>% 
  filter(site == "Hovland 3") 

h3dat <- R_Date(h3$lab_code, h3$c14_bp, h3$error)
h3_sum <- oxcal_Sum(h3dat)
h3_run <- executeOxcalScript(h3_sum)
h3_text <- readOxcalOutput(h3_run)
h3_result <- parseFullOxcalOutput(h3_text)

oxcal_code <- paste(' Plot()
   {
    Sequence()
    {
     Boundary("Start");
     Phase()
     {',
      h3dat,
     '};
     Boundary("End");
    };
  };')
my_result_file <- executeOxcalScript(oxcal_code)
my_result_text <- readOxcalOutput(my_result_file)
my_result_data <- parseOxcalOutput(my_result_text)

my_oxcal_code <- ' Plot()
 {
  Sequence("Sequence1")
  {
   Boundary("Beginn");
   Phase("Phase1")
   {
    R_Date("Lab-1",5000,25);
    R_Date("Lab-2",4900,37);
   };
   Boundary("Between");
   Phase("Phase2")
   {
    R_Date("Lab-3",4800,43);
   };
   Boundary("End");
  };
 };'

```

The `r nrow(sites)` coastal sites chosen for analysis here have a relatively limited geographical distribution in south-eastern Norway \ref\@(fig:dist)A]. The sites were excavated as part of four larger excavation projects that all took place within the last 15 years [@solheim2013b; @jaksland2014a; @melvold2014b; @reitan2014l; @solheim2017b]. The sites included in the analysis consists of all Mesolithic sites excavated in conjunction with the projects that have assemblages holding more than 100 artefacts. The institution responsible for these excavations was the Museum of Cultural History in Oslo. This has led to a considerable overlap in the archaeological personnel involved, and comparable excavation practices across the excavations. Furthermore, with these projects, major efforts were made to standardise how lithic artefacts were to be classified at the museum. As a result, this should reduce the amount of artificial patterning in the data incurred by discrepancies in the employed systems for categorisation [e.g. @clark2006; @dibble2017]. In this setting, for example, bias could potentially follow from the fact that two of the projects have sites with relatively contemporaneous dates [@solheim2013b; @jaksland2014, see also \ref\@(fig:dist)B]. Any project-dependent classification practice could as a consequence lead to an exaggeration of chronological differences between the assemblages. While this is difficult to fully account for, I do believe that the relative contemporaneity of the excavation projects, as well as the overlap in excavation and classification practices should minimise the above-mentioned effects, making the data-set a good candidate for exploratory data analysis.

```{r dist, fig.cap = "A) Spatial and B) temporal distribution of the sites chosen for analysis. The date ranges follow those given in the original excavation reports", fig.height = 10, fig.width = 12}
# Create a bounding box around site points to limit the overview map
sitbbox <- st_bbox(site_pts)
sitbbox[1:2] <- sitbbox[1:2] - 600000
sitbbox[3:4] <- sitbbox[3:4] + 600000
boundingpoly <- st_as_sf(st_as_sfc(sitbbox))

# Reproject the bounding box to match world map, and crop the world map
# with the bounding box polygon
bound_reproj <- st_transform(boundingpoly, st_crs(countries))
mapcountries <- countries %>% 
  filter(st_intersects(., bound_reproj, sparse = FALSE))
count_reproj <- st_transform(mapcountries, st_crs(site_pts))

# Create bounding box around the sites, both for extent indicator on the
# overview map and to create basemap for the site overview.
sitbbox2 <- st_bbox(site_pts)
sitbbox2[1:2] <- sitbbox2[1:2] - 15000
sitbbox2[3:4] <- sitbbox2[3:4] + 15000
boundingpoly2 <- st_as_sf(st_as_sfc(sitbbox2))

# same as above, using the smaller bounding box
bound_reproj2 <- st_transform(boundingpoly2, st_crs(countries))
mapcountries2 <- countries %>% 
  filter(st_intersects(., bound_reproj2, sparse = FALSE))
count_reproj2 <- st_transform(mapcountries2, st_crs(site_pts))

# Assemble overview map
overview <-
  ggplot() +
  geom_sf(data = count_reproj, fill = "grey", colour = NA) +
  geom_sf(data = boundingpoly2,
          fill = NA, colour = "black", size = 1) +
  coord_sf(xlim = c(sitbbox[1], sitbbox[3]), ylim = c(sitbbox[2], sitbbox[4]),
         expand = FALSE) +
  labs(title = "A") +
  theme_bw() + theme(axis.title=element_blank(),
                     axis.text.y = element_blank(),
                     axis.text.x = element_blank(),
                     rect = element_rect(),
                     axis.ticks = element_blank(),
                     panel.grid.major = element_blank()) 

# Combine spatial point data with assemblage data (holds excavation project
# for colouring points in the maps)
sitejoin <- right_join(site_pts, sites, by = c("LOKID" = "askeladden_id"))

# Assemble site map. anc defined first is used for placing the scalebar,
# which required some tweaking to get right.
anc <- as.numeric(c(sitbbox2$ymin, sitbbox2$xmax))
sitemap <-
  ggplot() +
  geom_sf(data = count_reproj2, fill = "grey", colour = NA) +
  geom_sf(data = sitejoin, aes(fill = excavation_project),
          size = 2.25, shape=21, 
          colour = "black") +
  labs(fill = "Excavation project") +
  scale_fill_manual(labels = c("E18 Bommestad-Sky", "E18 Brunlanes",
                               "E18 Rugtvedt-Dørdal", "Vestfoldbaneprosjektet"),
                    values = c("springgreen4", "royalblue2",
                                "gold1", "firebrick3")) +
  ggsn::scalebar(data = site_pts, dist = 10, dist_unit = "km", 
                 transform = FALSE, st.size = 4, height = 0.05, 
                 border.size = 0.05, st.dist = 0.07,
                 anchor = c(x = anc[2] - 8000, y = anc[1]) + 4000) +
  coord_sf(xlim = c(sitbbox2[1], sitbbox2[3]), 
           ylim = c(sitbbox2[2], sitbbox2[4]),
         expand = FALSE) +
 theme_bw() + theme(axis.title=element_blank(),
                     axis.text.y = element_blank(),
                     axis.text.x = element_blank(),
                     rect = element_rect(),
                     axis.ticks = element_blank(),
                     panel.grid.major = element_blank(),
                     legend.position = "none") +
  guides(fill = guide_legend(ncol = 2,
                             title.position = "top", title.hjust = 0.5))

yrs <- seq(11500, 5000, -500)
temp_dist <- ggplot(sites, aes(x = yrs, y = reorder(site, mean_date))) +
  geom_segment(aes(x = reported_start_bp, xend = reported_end_bp,
                   yend = reorder(site, mean_date),
                   colour = excavation_project), size = 1.7) +
  xlab("Cal. BP") +
  scale_x_reverse() +
  scale_colour_manual(labels = c("E18 Bommestad-Sky", "E18 Brunlanes",
                               "E18 Rugtvedt-Dørdal", "Vestfoldbaneprosjektet"),
                     values = c("springgreen4", "royalblue2",
                                "gold1", "firebrick3")) +
  labs(title = "B", colour = "Excavation project") +
  theme_classic() +
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        legend.position = "bottom") +
  guides(colour =  guide_legend(title.position = "top", title.hjust = 0.5))


(overview + sitemap) /
(temp_dist + theme(plot.margin = unit(c(0,135,0,135), "pt"))) 


```

A defining characteristic of the Norwegian Mesolithic is that a clear majority of the known sites are located in coastal areas [@glørstad2010]. Furthermore, these coastal sites appear to predominantly have been located on or close to the contemporary shoreline when they were in use [@breivik2018; @solheim2020]. In south-eastern Norway, this pattern is combined with a continuous regression of the shoreline, following from isostatic rebound [e.g. @sørensen1979; @romundset2018]. The fairly rapid shoreline displacement means that the sites tend not to have retained their strategic or ecologically beneficial shore-bound location for long periods of time [cf. @perreault2019, 47]. Consequently, the shore-bound settlement, combined with the rapid shoreline displacement has resulted in a relatively high degree of spatial separation of cumulative palimpsests, to follow the terminology of @bailey2007, while shoreline displacement combined with shore-bound settlement allows for a relatively good chronological control of these accumulation events. In other parts of the world, a higher degree of spatial distribution means that while the physical separation of material can help delineate discrete events, this typically comes at the cost of loosing temporal resolution, as any stratigraphic relationship between the events is lost [@bailey2007]. However, as the rate of isostatic rebound has varied throughout the Mesolithic in the region, and local topography and bathymetry will have impacted how rapidly a site lost its shore-bound location, this effect is not evenly distributed in time and space. In the earliest part of the Mesolithic, the displacement rate within the study area would have been around as much as 8.8 cm/year, falling to around 0.5 cm/year in the Late Mesolithic [@sørensen2014]. Thus, while relative sea-level change appears to have reduced the degree of mixing that has occurred in the assemblages, this could vary depending on when and where they were in use, in turn potentially reducing the degree to which their composition can be directly compared --- a point that is returned to in the discussion of the results.

The data analysed here is based on the classification of the `r nrow(sites)` site assemblages done for the original excavation reports, and consists of `r ncol(select(sites, core:flake_retouch_other))` variables representing different debitage and tool types. While the classification practices for the excavation projects were standardised to an extent, there are some instances where time was allocated to identify additional artefact sub-categories aimed at answering specific research questions. Some categories in the original reports have therefore been combined in the dataset. This for example pertains to the category narrow-blades, which is defined as blades of width between 8 and 12 mm. In the reports, this was only separated from (macro-)blades (width $\ge$ 12 mm) and micro-blades (width $\le$ 8 mm) for some of the sites. Narrow-blades were combined with the blade category here. Furthermore, the artefact data have here been divided into flint and non-flint materials. Flint does not occur indigenously in Norway, and is only available locally as nodules that have been transported and deposited by retreating and drifting ice [e.g. @berg-hansen1999]. This means that the distribution and quality of the flint has been impacted by a diverse set of factors relating to climatic and geographical factors such as, but not limited to, topographic variability, shoreline morphology and ocean currents [@eigeland2015, 46]. An in depth-analysis of the flint quality from sevens sites did result in the finding that the flint quality was relatively high, and consistently so across the sites. However, despite flint being treated as a unified category here, the cited study by was based on only seven sites located some km distance from the present study area, meaning that the results might not necessarily be transferable to the sites treated here [@eigeland2015, 45-53]. Furthermore, the various non-flint raw materials that have been lumped together here can have quite disparate properties, where fine-grained cryptocrystalline materials are often used as a substitute or supplement to flint, while other, coarser materials are usually associated with the production of axes and other macro tools. Given this differentiated use, these raw-material properties are expected to be reflected in the retained debitage and tool categories. An important benefit of combining all of the non-flint materials is that this reduces the dependency on whether or not these have been correctly and consistently categorised for the reports [cf. @frivoll2017]. While certainly a topic deserving of more attention, the general sentiment in the literature is that there would have been stable access to locally available non-flint raw-materials of good quality in south-eastern Norway [@eigeland2015, 370].

The date ranges provided for the sites are taken from the original excavation reports, and are the result of a consideration of typological indicators, dating with reference to shoreline displacement, and radiocarbon dates where these are available. Employing these date-ranges was deemed sufficient, as the main purpose is to get at general tendencies in the material, and not fine-grained chronological developments.

In a series of case studies from Northern Norway, @bølviken1982 were among a group of scholars often attributed the popularisaton of correspondence analysis (CA) in wider archaeologcal circles [@baxter1994]. In southern Norway, however, the use of multivariate statistics in Mesolithic research is to my knowledge limited to @solheim2013a use of CA to analyse the assemblage data from eight sites excavated in connection with a development-led project. As these sites, which are included in this study, have relatively contemporaneous dates, the Solheims analysis was mainly aimed at identifying potential variation in the

Previous studies of lithic artefacts in Norway have typically had a focus on chronological trends associated with formal tool types [e.g. @helskog1976; @reitan2016], involved refit-studies of the entirety of individual assemblages [@skar1986], or been concerned with technological processes associated with certain sub-categories of the site inventories, such as blades or axes [e.g. @damlien2016; @solheim2020]. Some studies have involved in-depth analyses of handful of sites in terms of intrasite spatial organisation [@nærøy2018], and technological organisation [@eigeland2015; @mansrud2016;]. There are also some more comprehensive evaluations of a larger number of entire lithic assemblages to get at potential site types and associated mobility patterns [@breivik2016; @viken2018c; @breivik2020]. However, the narratively driven analyses of these data makes the weighting of different variables unclear, and these studies draw their conclusions based on an arguably over-constraining predefined trichotomy of site types. Each site could have had complex life histories and been associated with a wide range of tasks that in sum make up the assemblages. Finally, only a single study concerned with eight Middle-Mesolithic assemblages --- assemblages that are also treated here --- has employed a multivariate quantitative framework to help structure such a treatment [@solheim2013]. In sum, therefore, previous studies are typically either limited to a small number of sites, to a subset of the inventories, or to more subjectively and narratively driven methods.

There have been a few studies that have conducted comprehensive analyses of artefact inventories and site features to get at variation in Mesolithic site types [@viken2018; @breivik2020]. As Binford originally clarified, a point that has also been retiterated by several authors since; these categories are best understood as extremes on a continuous scale.

## Methods

The first part of the analysis conducted here involves employing the method of correspondence analysis (CA), using the lithic count data as classified for the original excavation reports. The purpose of this exercise is to evaluate the degree to which the composition of the assemblages align with patterns that have been suggested by earlier studies that have employed more informally driven methods when the entirety of the assemblages are taken into account. This consequently assumes that the artefact categories employed in Norwegian Stone Age archaeology are, at least to a certain extent, behaviorally meaningful. However, the approach taken is also partially informed by the so-called Frison effect [@jelinek1976], which pertains to the fact that lithics studied by archaeologists can have had long and complex use-lives in which they took on a multitude of different shapes before they were ultimately discarded. Several scholars have built on this to argue that morphological variation in retouched lithics cannot be assumed to predominantly be the result of the intention of the original knapper to reach some desired end-product, but rather that what is commonly categorised as discrete types of artefacts by archaeologists can instead in large part be related to variable degrees of modification through use and rejuvination [e.g. @barton1991; @dibble1995]. Consequently, several artefact categories have here been collapased for the CA. This for example pertains to tool types such as scrapers, burins, drills, knives and otherwise indeterminate artefacts with retouch. That these categories are internally consistent and categorically exclusive in terms of fulfilled purpose is at best a dubious proposition, in turn potentially rendering their contribution as discrete analytic units misleading. These have all been combined into the single category "small flint tools". (A full overview of the aggregated variables and their constituent parts is provided in the supplementary material). While aggregating artefact categories in this manner could potentially subsume important variation, it does also reduce the possibility that any conclusions are not simply the result of employing erroneous units of analysis. An underlying assumption is therefore that the retained categories represent artefact categories that have fulfilled different purposes or are related to different technological processes. While ultimately intuitive in nature, it does seem reasonable to assume that for example large non-flint stone tools such as axes, adzes, chisels, clubs and hatches, here categorised as non-flint macro tools, have fulfilled different purposes than the previously mentioned small flint tools.

However, the fact that for the most part we lack even a most basic understanding of what any individual lithic object has been used for does have major implications that the above-outlined analysis does not take properly into account, and renders it difficult to align any identified patterns with specific behavioural dimensions [@dibble2017]. For example, a vast amount of artefacts defined as debitage are likely to have fulfilled the function of tools, and both debitage and formal tool types could have had various different purposes and had a multitude of shapes throughout their use-life. While use-wear analysis could potentially offer a way to identify what artefacts were used for towards the end of their use-life, these kinds of analyses are extremely time-consuming and are therefore typically only conducted on a smaller number of artefacts that have already been selected for analysis based on their shape [e.g. @solheim2018]. Thus, while these analyses can potentially get at in-group variation pertaining to the end-state of a group of artefacts, they do not tell us whether or not their classification as a unified group is meaningful in the first place [@dibble2017]. As a consequence, the second part of the analysis employs a suite of measures developed for the classification of lithic assemblages developed with these inferential limitations in mind [see @clark2017, and below]. The logic behind these measures are founded on an understanding of technology as being organised along a continuum ranging between curated and expedient [@binford1979]. An expedient technological organisation pertains to the situational production of tools to meet immediate needs, with little investment of time and resources in modification and rejuvination, resulting in high rates of tool replacement. Curated technological organisation, on the other hand, has been defined as related to manufacture and maintenance of tools in anticipation of future use, the transport of these artefacts between places of use, and the modification and rejuvenation of artefacts for different and changing situations [@binford1979]. Although precisely how it is measured may vary, the empirical correspondent to a curated technological organisation is therefore typically defined by high degrees of retouch, as this is commonly seen as a means of realising the potential utility of a tool or extending its use-life by the repeated rejuvination and modification of edges [e.g. @bamforth1986; @dibble1995; @shott2005]. The continuum between curated and expedient technology has in turn been related to land-use and mobility strategies, as well as raw-material quality and availability [e.g. @parry1987; @kuhn1992; @andrefsky1994; @smith2015; @clark2017].

While the definition of curation, its archaeological correlates, and behavioural implications have been widely discussed [e.g. @bamforth1986, @shott1996], following not least from the ambiguous definition first put forward by @binford1979, some concrete operationalisation of the terms have been suggested. Through a series of studies Barton and collegues [e.g. -@barton1999; @barton2014; @clark2017] have shown that the relationship between lithic volumetric density and relative frequency of retouched artefacts provide consistent results across a wide range of chronological and cultural context. This measure is taken to reflect degree of curation associated with the assemblages, which in turn is mainly to follow from variation in mobility patterns associated with the sites [@barton2014]. Higher degree of mobility would mean a higher dependency on the artefacts and the material people could bring with them, and dimensions such as weight, reliabilty, repairability, and the degree to which artefacts could be manipulated to fulfill a wide range of tasks are therefore assumed to have been factors of concern. From this it follows that the empirical expectation for short-term camps is a curated technological organisation with higher relative frequency of retouched artefacts, and a lower overall density of lithics [@clark2017]. More time spent in a single location, on the other hand, is in this model assumed to lead to better control of raw-material availability and to allow for its accumulation. This should in turn lead to an expedient technological organisation with reduced necessity for the conservation of lithics and extensive use of retouch. The empirical expectation for lower degree of mobility is therefore relatively high density of lithics and a low relative frequency of retouched artefacts. A further empirical expectation of an expendient tehcnological organisation is a higher number of cores and unretouched flakes and blades [@clark2017].

This is the main measure employed here. Some additional variables suggested by @Bicho2020 to be related to mobility patterns are subsequently also explored using principal components analysis (PCA), following the continuous operationalisations of these measures [cf. @baxter1994, 100].

A note should also be made on the fact that a couple of variables that are sometimes invoked for the classification of sites in terms of associated mobility pattern are omitted here. This pertains to number of site features such as fireplaces, cooking pits and dwelling structures. Feature count has been omitted as taphonomic loss is likely to lead to a chronological bias in their preservation. Similarly, the number of activity areas, effectively number artefact clusters, however defined, has also been disregarded. This follows most notably from the fact that the impact of post-depositional processes at Stone Age sites in Norway is arguably understudied. This pertains for example to the impact of bioturbation in the form of three-throws, which can can have a detrimental effect on the original distribution of artefacts, and which can be expected to have been relatively frequent on several of the sites treated here [@jørgensen2017; @darmark2018e].

Within this framework, amount of retouch has been seen as a empirical indicator of degree of curation. While various methods for measuring the curation associated with individual tools have been forwarded, the approach taken here focuses on the assemblage considered as a whole.

Here retouch i At logistical basecamps, the extended time spent in a single location would imply a better control of raw material availability, and allow for longer trips to retrieve these. Higher availability of lithic raw materials should in turn reduce the necessity for extensive retouch, meaning the material expectation for logistical basecamps would be relatively high density of lithics and a low relative frequency of retouched artefacts. From this it follows that the empirical expectation for short-term camps is a higher relative frequency of retouched artefacts, and a lower overall density of lithics [@clark2017].

# Theory/calculation

Higher frequency of secondarily worked lithics

# Results

```{r lithics}
lithics <- sites %>%
  # Combine flint projectiles into a single variable
  mutate(
    projectile = microlith + tanged_point + transverse_point + 
    single_edged_point + hognipen_point + projectile_undefined,
    small_tool = scraper + knife + burin + drill + blade_retouch + 
      microblade_retouch + chip_retouch + fragment_retouch + flake_retouch,
    macro_tool = axe + chisel, 
    macro_tool_other = axe_other + chisel_other + club_hatchet_other,
    small_tool_other = knife_other + scraper_other + drill_other + 
      microblade_retouch_other + blade_retouch_other + fragment_retouch_other +
      flake_retouch_other,
    .keep = "unused") %>%
  # Make site names the rownames
  column_to_rownames(var = "site") %>% 
  # Deselect a few of the columns not be used
  select(-n, -excavation_project, -excavated_m3, -dating_method)
```

```{r co_data}
# Perform correspondence analysis on the data. 'mean_age' is meant for colouring
# so is excluded here
calithics <- CA(select(lithics, -mean_date, -artefact_count, -flint_count, 
                       -nonflint_count, -reported_start_bp, -reported_end_bp,
                       -askeladden_id),
                graph = FALSE)

# Retrieve eigenvalues
eigval <- get_eigenvalue(calithics)
explained_cumul_dim2 <- eigval[2,3]

# Find date to hold the central tendency date
centdate <- (sum(range(lithics$mean_date)) / 2) / 1000
```

```{r cor1, fig.cap = "Correspondence analysis using artefact count data.", fig.height = 8, fig.width = 10, eval = FALSE}
# Plot with site names tags (probably most immediately relevant for an audience 
# familiar with the sites)
fviz_ca_row(calithics, col.row = "black", fill = lithics$mean_date / 1000, title = "A",
                     repel = TRUE, shape = 21, pointsize = 2.9) +
  scale_fill_gradient2(name = "ka BP", low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 
```

```{r cor, fig.cap = "Correspondence analysis using artefact count data. A) Object map, B) Variable map.", fig.height = 13}
# Plot without site names tags
plt1 <- fviz_ca_row(calithics, geom = "point", col.row = "black", fill = lithics$mean_date / 1000, title = "A",
                     repel = TRUE, shape = 21, pointsize = 2.9) +
  scale_fill_gradient2(name = "ka BP", low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 
#guide(fill = guide_legend(reverse = TRUE)) # Reverses the legend but makes it
                                            # discrete

# Plot variables
plt2 <- fviz_ca_col(calithics, col.col = "black", repel = TRUE, title = "B") 

plt1 /
plt2

```

Figure \@ref(fig:cor) displays the CA using the lithic count data. While no clear-cut clusters can be readily delineated, the general impression from the plots is that a chronological dimension is associated with the patterning in the data. This is indicated by the general transition across the colour scale in the row plot (Figure \@ref(fig:cor)A), combined with the fact that the two first dimensions of the CA accounts for as much as `r round(explained_cumul_dim2, 2)` % of the inertia or variance in the data. The earliest sites tend to be located in the upper right corner of plot A, with increasingly younger sites towards the bottom along the second dimension. Although fewer in number, the sites from the later parts of the Mesolithic are drawn out along the first dimension of the plot, and are not as impacted by the second dimension as the more numerous older sites.

The column plot (Figure \@ref(fig:cor)B) reveals that the earliest sites are characterised by the flint artefact categories microburins, projectiles, as well as flint macro tools and associated debitage. It is also interesting that these sites to larger extent are characerised by core fragments, both in flint and non-flint materials, than cores themselves. The non-flint material on the earliest sites appears to be centered around the production of projectiles, as both the projectiles themselves and non-flint blades are important constituents of the assemblages at these sites. These findings are in large part in line with previous research [e.g. @bang-andersen2003], although possibly highlighting the importance of the non-flint materials to a larger extent than what has traditionally been the case.

The first dimension, which is pulling some of the later sites towards the right of the plot, is mainly defined by macro tools and associated debitage in non-flint materials that are negatively correlated with more flint dominated assemblages and non-flint projectiles. While the outer end of the first dimensions is dominated by later Mesolithic sites associated with axe production in non-flint materials, the later sites occur along the entire dimension, indicating that while these axe production sites are a feature of the later Mesolithic, there is marked variation among these later sites. Although the sample size is quite strained and the discussion of finer chronological points might not be warranted, the first dimension does appear to be of of less importance for the absolute latest sites, as indicated by their location to the left of the plot. This could indicate that specialised axe production sites disappear towards the end of the Mesolithic, a notion that would be in line with previous research [e.g. @eigeland2015, 370, @glørstad2011].

In addition, Nedre Hobekk 2 represents a somewhat curious case in that its assemblage is dominated by axe production in metarhyolite. The use of metarhyolite is typically seen as a feature of the end of the EM and the MM, but is evidently not as prominent a part of other sites that are contemporaneous with Nedre Hobekk 2.

# 

Reducing the number of such inferential leaps by aggregating artefact groups could potentially subsume important variation, but it does also reduce the possibility that the conclusions of any analysis is not simply the result of the employed units of analysis, and an overly naive trust in the fact that these units reflect any behaviourally meaningful categories. This realisation has led to a wide range of outside Scandinavian Mesolithic research, meaning a range of empirical measures associated with various mobility patterns are available.

It has, however, been suggested that access to raw-materials can be a more important decider for assemblage composition than mobility patterns , and that variable workability of these materials will impact factors such as the relative frequency of tools to debitage in the assemblages [e.g. @andrefsky1994; @manninen2014]. In addition to attempts at accounting for this analytically (see below), the limited geographical distribution of the sites should alleviate the issue somewhat, as the overall availability of raw materials could be expected to be more comparable through time than if a wider region was under consideration.

Of these the most well-estbalished is the. base don the assumption that, this measure and has been shown to display a meaningful measure across a wide range of temporal, geographical and cultural contexts.

```{r pcadata}
# Tried to do this to avoid having to type the variable names into both mutate()
# and select(). The general syntax select(-(vector_of_variable_names)) worked,
# but not: mutate(new_varaible = sum(vector_of_variable_names) / artefact_count)
blanks_flint <- c("blade", "microblade", "fragment", "flake")

blanks_lithics <- c(blanks_flint, "flake_other", "fragment_other", 
                     "blade_other",  "microblade_other")

secondary_flint <- c("axe_debitage", "axe", "chisel", "microlith", 
                    "tanged_point", "transverse_point", "single_edged_point",
                    "hognipen_point", "projectile_undefined", "microburin",
                    "scraper", "knife", "burin", "drill", "blade_retouch",
                    "microblade_retouch", "chip_retouch", "fragment_retouch",
                    "flake_retouch")

secondary_lithics <- c(secondary_flint, "axe_other", "axe_debitage_other",
                       "chisel_other", "club_hatchet_other", 
                       "grinding_slab_stone", "projectile_point_other", 
                       "knife_other", "scraper_other", "drill_other", 
                       "microblade_retouch_other", "blade_retouch_other",
                       "fragment_retouch_other", "flake_retouch_other")

lithics2 <- sites %>% 
  select(-n, -beach_flint_flint_nodule, -hammerstone, -excavation_project,
         -reported_start_bp, -reported_end_bp, -askeladden_id) %>% 
  # The reason for not using .keep below is for the option to 
  #retain artefact_count
  mutate(chip_freq =  sum(chip, chip_other) / artefact_count,
         core_freq = sum(core, core_other) / artefact_count,
         blanks_freq = sum(blade, microblade, fragment, flake, flake_other, 
                     fragment_other, blade_other,  microblade_other) / artefact_count,
         secondary_freq =  sum(axe_debitage, axe, chisel, 
                microlith, tanged_point, transverse_point, single_edged_point,
                hognipen_point, projectile_undefined, microburin, scraper, 
                knife, burin, drill, blade_retouch, microblade_retouch, 
                chip_retouch, fragment_retouch, flake_retouch, axe_other,
                axe_debitage_other, chisel_other, club_hatchet_other, 
                grinding_slab_stone, projectile_point_other, knife_other,
                scraper_other, drill_other, microblade_retouch_other, 
                blade_retouch_other, fragment_retouch_other,
                flake_retouch_other) / artefact_count,
         nonflint_freq = nonflint_count / artefact_count,
         lithic_dens = artefact_count / excavated_m3) %>%
  select(-blanks_lithics, -secondary_lithics, -excavated_m3, -artefact_count,
         -flint_count, -nonflint_count, -core, -core_fragment, -chip, 
         -chip_other, -core_other, -core_fragment_other, -dating_method) %>% 
  column_to_rownames("site")


# Repeat but for flint only
flint2 <- sites %>% 
  select(-n, -beach_flint_flint_nodule, -hammerstone, -excavation_project, 
         -reported_start_bp, -reported_end_bp, -askeladden_id) %>% 
  select(!ends_with("other")) %>% 
  mutate(chip_freq =  sum(chip) / artefact_count,
         core_freq = sum(core) / artefact_count,
         blanks_freq = sum(blade, microblade, fragment, flake) / artefact_count,
         secondary_freq =  sum(axe_debitage, axe, chisel, 
                microlith, tanged_point, transverse_point, single_edged_point,
                hognipen_point, projectile_undefined, microburin, scraper, 
                knife, burin, drill, blade_retouch, microblade_retouch, 
                chip_retouch, fragment_retouch, flake_retouch) / artefact_count,
         flint_dens = flint_count / excavated_m3) %>%
  select(-blanks_flint, -secondary_flint, -excavated_m3, -artefact_count,
         -flint_count, -nonflint_count, -grinding_slab_stone, -core, 
         -core_fragment, -chip, dating_method) %>% 
  column_to_rownames("site")

wabicor <- cor(log10(lithics2$lithic_dens), log10(lithics2$secondary_freq))
wabicorflint <- cor(log10(flint2$flint_dens), log10(flint2$secondary_freq))
```


```{r cor-plot, fig.cap = "Correlation plot showing transformation of skewed variables for the PCA, and the linear correlation between these", fig.height = 9.5, fig.width = 10}
# Transform the skewed variables - sqrt() is used where there are zero values,
# and seems to provide an adequate result.
lithicstr <- lithics2 %>%
  # Transform skewed variables and reorder
  mutate("Mean date cal. BP*-1" = mean_date * -1,
          "log10(lithic_dens)" = log10(lithic_dens),
         "log10(secondary_freq)" = log10(secondary_freq),
         "core_freq^(1/3)" = core_freq^(1/3),
         "nonflint_freq^(1/3)" = nonflint_freq^(1/3),  .keep = "unused") %>% 
  relocate("Mean date cal. BP*-1",
    "log10(lithic_dens)", "blanks_freq", "log10(secondary_freq)",
    "chip_freq", "core_freq^(1/3)" 
  )

corr_plot(lithicstr)
```

```{r pca-analysis, fig.cap = "PCA using variables related. Note that details on the transformation of the variables has been left out of the plot for clarity.", fig.height = 7, fig.width = 10}
# Rename the transformed variables again to avoid clutter in the plot. 
# Specify in figure caption that the transformed variables are used 
lithicspca <- lithicstr %>% 
  mutate(mean_date =  `Mean date cal. BP*-1` * -1, .keep = "unused") %>% 
  rename(
   lithic_dens = "log10(lithic_dens)",
   secondary_freq = "log10(secondary_freq)",
   core_freq = "core_freq^(1/3)",
   nonflint_freq = "nonflint_freq^(1/3)"
  )


pcalithics <- PCA(select(lithicspca, -mean_date),
                  scale.unit = TRUE, graph = FALSE)
fviz_pca(pcalithics, geom.ind = "point", fill.ind = lithicspca$mean_date / 1000, 
          repel = TRUE, col.var = "black", pointshape = 21,  pointsize = 2.9,
         title = "") + 
  scale_fill_gradient2(name = "ka BP",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 

```

To visualise this more clearly, a curation index based on the two variables was devised by perfoming a min-max normalisation on the two variables, scaling them to take on values between 0 and 1. The values for artefact density was then made negative to reflect its relationship with degree of curation. The mean was then found for each site on these two normalised values. Plotting the results indicates a higher degree of curation among the earliest sites, which then falls and settles without any further major fluctuations.

Figure \@ref(fig:pca-analysis) displays a principle components analysis using variations of the continuous measures for mobility patterns as operationalised by @clark2017 and @Bicho2020. While the investigation performed by @Bicho2020 indicates that the relative frequency of chips, cores, and blanks might be more sensitive to mobility patterns, they also found that the relationship between volumetric density of lithics and the frequency of retouched artefacts gave a reasonable estimation of mobility in their data. hese last dimensions are capturing the most variation in the dataset presented here. Thus, if frequency of secondarily worked artefacts and volumetric density of lithics is accepted as a proxy for degree of mobility, these findings would consequently be in line with previous research into the Mesolithic of Norway, indicating that earlier sites are associated with higher degree of mobility than sites from later phases. Furthermore, the fact that these

```{r eigenvalues, fig.cap = "Table showing the eigenvalues of the components."}
# Create a table showing the eigenvalues of the components
round(as.tibble(get_eig(pcalithics)), 2) %>% 
  rename("Eigenvalue" = eigenvalue, "Variance (%)" = variance.percent, 
         "Cumulative variance (%)" = cumulative.variance.percent) %>% 
  rownames_to_column(var = "Component") %>% 
gt(rowname_col = "row", auto_align = FALSE)
```

```{r var_contrib, fig.cap = "Contribution of variables to components.", fig.height = 3}
# The plots below investigates the contribution of the variables to the
# components. The code has in large part been taken from 
# Bicho & Cascalheira (2020).
var <- get_pca_var(pcalithics)
dim1 <- fviz_contrib(pcalithics, choice = "var", axes = 1,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 1")
dim2 <- fviz_contrib(pcalithics, choice = "var", axes = 2, 
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 2")
dim3 <- fviz_contrib(pcalithics, choice = "var", axes = 3,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 3")
dim4 <- fviz_contrib(pcalithics, choice = "var", axes = 4,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 4")

# Patchwork for arranging plots
(dim1 | dim2) 
#(dim3 | dim4)
```

```{r var_cor, fig.cap = "Plots showing the correlation between the variables", eval = FALSE}
plt1 <- fviz_pca_var(pcalithics,
                  col.var = "black",
                  title = "Correlation plot: Component 1/Component 2",
                  repel = TRUE
                  )
plt2 <- fviz_pca_var(pcalithics,
                  col.var = "black",
                  axes = 3:4,
                  title = "Correlation plot: Component 3/Component 4",
                  repel = TRUE
                  )

plt1 + plt2
```

Figure \@ref(fig:wabi) displays the WABI as found for the site data. This indicates a negative correlation between the two variables (r = `r round(wabicor, 2)`) and a general tendency for younger sites to be associated with a higher volumetric density of lithics and a lower relative frequency of secondarily worked lithics than older sites. Following @clark2017, this would be in line with a general transition from a expedient to curated lithic technology. Variable raw-material availability can also impact these measures as [@manninen2014]. Variation in raw-material use over time could consequently mean that these patterns could be an effect of the available raw material rather than mobility strategies. However, as is evident in when considering both plots in \@ref(fig:wabi), the pattern is evident for both the lithics considered in aggregate and for the flint data specifically. Although the distribution is slightly more spread out along the y-axis than the x-axis in the flint data, indicating that differences in volumtric density of flint is not as clearly chronologically, the general pattern is the same.

```{r wabi, fig.cap = "Relative frequency of secondarily worked lithics plotted against the volumetric density of artefacts (artefact count / excavated m^3^) for A) All lithics, B) Flint. The logarithm is taken to base 10 on all axes.", fig.height = 5, fig.width = 10}
w1 <- ggplot(lithics2, aes(lithic_dens, secondary_freq * 100, 
                     fill = mean_date / 1000)) + 
  geom_point(shape = 21, size = 3) +
  geom_smooth(method = "lm", col = "black", se = FALSE) +
  labs(title = "A",
       x = "Volumetric density of lithics (log10)", 
       y = "Relative frequency of secondarily worked lithics (log10)") +
  scale_fill_gradient2(name = "ka BP",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  scale_y_log10() +
  scale_x_log10() +
  theme_classic()

w2 <- ggplot(flint2, aes(flint_dens, secondary_freq * 100, 
                     fill = mean_date / 1000)) + 
  geom_point(shape = 21, size = 3) +
  geom_smooth(method = "lm", col = "black", se = FALSE) +
  labs(title = "B", 
       x = "Volumetric density of flint (log10)", 
       y = "Relative frequency of secondarily worked flint (log10)") +
  scale_fill_gradient2(name = "ka BP",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  scale_y_log10() +
  scale_x_log10() +
  theme_classic()



w1 | w2
```

```{r index}
# Create curation index
minmax <- lithics2 %>% 
  mutate(dens =  ((lithic_dens - min(lithic_dens)) / (max(lithic_dens) - min(lithic_dens))),
         secondary = ((secondary_freq - min(secondary_freq)) / (max(secondary_freq) - min(secondary_freq))))

indexdata <- minmax %>% 
  rowwise() %>% 
  mutate(index = mean(c(dens * -1, secondary)))

w3 <- ggplot(indexdata, aes(x = mean_date, y = index)) + 
  geom_point() +
  labs(title = "C",
       x = "Mean date cal. BP",
       y = "Curation index") +
  scale_x_reverse() + 
  geom_smooth(method = "loess", col = "red") +
  theme_classic() 
w3
```
# Discussion

The results of the CA does appear to align reasonably well with previous research that has been based on more informal analyses of artefact types, indicating that the employed artefact categories are capturing some behaviorally meaningful patterning that changes over time. However, as several authors have pointed out in relation to the application of CA for seriation purposes, 'time is not the only dimension'. The developments evident here do also most certainly correspond to more pervasive cultural change than a purely typo-chronological development of artefact morphology, highlighted perhaps most clearly by the influence of the later Mesolithic axe production sites. Unpicking and aligning the signficance of these chronological patterns with any specific behavioural dimensions using the CA results is, however, another task entirely. This follows most clearly from the fact that for the most part we lack even a most basic understanding of what any individual lithic object has been used for, leaving the behavioural significance of the employed units of analysis unclear (see section, above).

these results do speak to the cross-cultural and cross-temporal applicability of the measure, and consequently the potential it holds for comparative studies. The findings indicated by the WABI, as well as by the negative correlation between relative frequency of primarily and secondarily worked lithics, do align more clearly with previous suggestions concerning the overall mobility patterns in Mesolithic Norway. However, the question then becomes: What is the significance of the negatively correlated variables of relative frequency of cores and chips? Given that these are more or less orthogonal to the WABI variables on the first and second component, this would indicate that if one of these variable pairs is taken to reflect the scale between expedient and curated technologies, it should follow that the other variable pair is not correlated with these. As the entire temporal range of the sites is spread out between the extremes of the chip and core variables, one possibility is that these are indicative of site types that are temporally ubiquitous. In attempt to determine if this might be the case, it was decided to introduce site locational data from a previous study that in addition to surveyed sites involved the analysis of the sites treated here @roalkvam2020. Of the variables considered, this study found that the most consistently important environmental covariates for the location of sites in the region was related to the exposure of the sites, and failed to identify any diachronic variation in this pattern. As it has previously been proposed that sites located in areas exposed to wind and waves and with large overview of surrounding areas is a characteristic of hunting stations or similarly temporary , one could envisage that variablity in site functionality might be reflected in degree of exposure. However, introducing these variables does not clarify the picture, as both variables show negligible degrees of correlation with any of the variables pertaining to the assemblage data.

This is arguably more established than the variables included bysimilarities between the variable plots of @Bicho2020 and the variables indicated in is striking. This pertains to the negative correlation between core and chip frequency, and the negative correlation between primary and secondarily worked lithics. This last

These measures are taken from the framework of whole assemblage behavioural index, as developed by , and is aimed to get at behavioural dimensions relating to mobility patterns among hunter-gatherers.

# Conclusion

The results of the CA using the entirety of the lithic assemblages align more or less with results of previous research in south-eastern Norway. This would indicate that in general, meaningful chronological patterning is associated with the employed artefact categories. These tendencies are already well-established when it comes to formal tool types, but the have been given less focus in terms of entire assemblages these notions have previously Precisely what behavioural implication the development in the use of these types have, however, is unclear

The results of considering variables that are have been associated with mobility patterns gave rise to two competing hypotheses. These pertain to whether the degree of curation associated with the assemblages as captured by the changing ratio of primary to secondarily worked lithics over time is the result of changing raw material availability or mobility patterns. The orthogonal relationship between core to chip frequency would in this framework be expected to be capturing the opposite relationship. If degree of curation mainly reflects changes in raw-material quality and availability, this would then indicate that mobility patterns are comparable throughout the Mesolithic as the core to chip frequency is not time-dependent. And vice verca --- if the changing mobility patterns is the main driver of the transition from curated to expedient technological organisation, as operationalised here, While this would be in line with findings from a recent evaluation of the locational patterns associated with the sites [@roalkvam2020], there is no readily available empirical evidence, no smoking gun, se findings are the results of an exploratory analysis, and are therefore perhaps best seen as potentially laying the framework for later targeted strategic test of these competing hypotheses.

<!-- The following line inserts a page break  -->

\newpage

# References

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

::: {#refs}
:::

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies:

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
