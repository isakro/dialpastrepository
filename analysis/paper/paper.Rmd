---
title: "Exploring the Composition of Lithic Assemblages in Mesolithic South-Eastern Norway"
header-includes:
   - \usepackage{lineno}
   - \linenumbers
author:
  - Isak Roalkvam:
      email: isak.roalkvam@iakh.uio.no
      institute: [UiO]
      correspondence: true
institute:
  - UiO: University of Oslo, Department of Archaeology, History and Conservation
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::pdf_document2:
      toc: false
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/saa.csl" # Insert path for the bib-style
abstract: |
  This paper leverages multivariate statistics to explore the composition of 54 Mesolithic assemblages located in south-eastern Norway. To provide analytical control pertaining to factors such as variable excavation practices, systems for artefact categorisation and raw-material availability, the sites chosen for analysis have all been excavated relatively recently and have a constrained geographical distribution. The assemblages were explored following two strains of analysis. The first of these entailed the use of artefact categories that are established within Norwegian Mesolithic archaeology, while the other involved drawing on measures that have been linked directly to land-use and mobility patterns associated with lithic assemblages more widely. The findings pertaining to the established artefact categories largely reflect the temporal development previously reported in Norwegian Mesolithic research, which has been based on more subjectively driven methods. Furthermore, the chronological trends associated with variables taken from the so-called Whole Assemblage Behavioural Indicators (e.g. Clark and Barton 2017), originally devised for characterising Palaeolithic assemblages in terms of associated mobility patterns, also align with the development previously proposed in the literature. This provides an initial indication that these measures are applicable in a Norwegian Mesolithic setting as well, setting the stage for a more targeted and rigorous model evaluation outside this exploratory setting. Furthermore, this finding supports the notion that these measures can offer a powerful comparative tool in the analysis of lithic assemblages more generally.

  
keywords: |
  Mesolithic Scandinavia; Multivariate Statistics; Mobility; Whole Assemblage Behavioural Indicators
---

Keywords: `r rmarkdown::metadata$keywords`

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.pos = "!h",
  fig.width = 9,
  fig.path = "../figures/",
  dpi = 300
)
```

```{r libraries, eval = TRUE, results = 'hide'}
library(tidyverse)
library(GGally)
library(ggridges)
library(patchwork)
library(knitr)
library(kableExtra)
library(FactoMineR)
library(factoextra)
library(networkD3)
library(sf)
library(rnaturalearth)
library(oxcAAR)
quickSetupOxcal()
```

```{r get-functions, include = FALSE}
source(here::here("analysis/script/plot_functions.R"), local = knitr::knit_global())

#setOxcalExecutablePath("/tmp/RtmpFVOcBJ")
```

```{r get-data, eval = TRUE, results = 'hide'}
assemblages <- read.csv(here::here('analysis/data/raw_data/assemblage_data.csv'))
radiocarbon <- read.csv(here::here('analysis/data/raw_data/radiocarbon_data.csv'))
site_pts <- st_read(here::here('analysis/data/raw_data/sites.gpkg'))

# ne_download() is currently failing
#countries <- ne_download(scale = 10, type = 'countries', category = 'physical',
#                         returnclass = "sf")
countries <- st_read(here::here('analysis/data/raw_data/naturalearth_countries.gpkg'))

# gis <- read.csv(here::here('../../site_data.csv'))
# gis$askeladden_id <- as.integer(str_replace_all(gis$askeladden_id, c("-1" = "", "-0" = "", "-2" = "", "-3" = "", "-4" = "")))
# gisjoin <- right_join(gis, sites, by = c("askeladden_id" = "askeladden_id"))
```

# Introduction

This study employs multivariate exploratory statistics to analyse lithic assemblages associated with Mesolithic sites located in south-eastern Norway. This is done to identify latent patterns and structure in the relationship between the assemblages, with the ultimate aim of identifying behaviourally induced variation in their composition across time. However, the composition of the assemblages can be expected to be determined by a multitude of factors [e.g. @dibble2017; @rezek2020], ranging from the impact of natural formation processes, to various and intermixed behavioural aspects such as purpose, duration, frequency and group sizes at visits to the sites. The assemblages are also likely to be impacted by variation in lithic technology, artefact function, use-life and discard patterns, as well as procurement strategies and access to raw materials. Finally, analytic and methodological dimensions relating to survey, excavation and classification practices are also fundamental to how the assemblages are defined. Consequently, the analysis conducted here is done from an exploratory perspective, where all of these factors should be seen as potential contributors to any observed pattern. In an attempt to limit the influence of some potentially confounding effects, the material chosen for analysis has a constrained geographical distribution, and stems from recent investigations that have employed comparable methods for excavation and classification within larger unified projects.

Even though each individual assemblage can have been impacted by an virtual infinitude of effects that might skew an archaeological interpretation, this does not preclude the applicability of inductive analyses aimed at revealing overarching structure in the data without imposing overly complex analytical frameworks that attempt to account for these particularities [@bevan2015]. Structure that can be revealed from considering all of the assemblages in aggregate can constitute a step in an iterative analytical chain that ultimately aims to tease apart the multitude of factors that have shaped the composition of the assemblages, and should be of value to subsequent in-depth studies of any individual site. The most immediate danger of the approach outlined here is rather to be overly naive in the causal significance and cultural importance that is ascribed to any identified pattern. As such, the main aim of this analysis is to compare the results with findings reported in previous literature concerned with the Mesolithic in southern Norway and have the generation of new hypotheses as a possible outcome. To this end, the analysis follows two analytical avenues. The first involves an analysis of the assemblages using the classification of the artefacts done for the original excavation reports. The second involves an analysis of the assemblages in light of the so-called Whole Assemblage Behavioural Indicators [e.g. @clark2017], which have been employed in other contexts to align properties of lithic assemblages with land-use and mobility patterns.

# Archaeological context and material

```{r wrangling}
sites <- assemblages %>% 
      # Find mean reported date for each site (to be used in the plots below)
  rowwise() %>% 
  mutate(mean_date = mean(c(reported_start_bc, reported_end_bc))) %>% 
  mutate(
    # Find total artefact count and flint count for each site
    artefact_count = sum(c_across(core:flake_retouch_other)),
    flint_count = sum(c_across(core:flake_retouch)),
    nonflint_count = sum(c_across(axe_other:flake_retouch_other))) %>%
  # Exclude sites with less than 100 artefacts
  filter(artefact_count > 100) %>% 
  arrange(mean_date) %>% 
  tibble::rownames_to_column(var = "no")
  
```

```{r c14-modelling, cache = TRUE}
# define function to model radiocarbon dates. Only assumption is that 
# dates from a single site belong to a single group
model_rcarb <- function(data){
  
  # Format individual dates for R_Date in Oxcal
  dates <- R_Date(data[["lab_code"]], data[["c14_bp"]], data[["error"]])
  
  # Manually compile rest of OxCal code
  oxcal_code <- paste0('
  Plot()
   {
    Sequence()
    {
     Boundary("Start");
     Phase()
     {
    ',
     dates,
     '
     Sum("Sum");
     };
     Boundary("End");
    };
  };')
  
  # Run OxCal code - wrapped this in some functions to  not print to 
  # rmarkdown
  invisible(capture.output(oxcal_exec <- executeOxcalScript(oxcal_code)))
  oxcal_read <- readOxcalOutput(oxcal_exec)
  # Note that parseOxcalOutput() defaults to only returning individual dates,
  # specified with only.R_Date
  oxcal_data <- parseOxcalOutput(oxcal_read, only.R_Date = FALSE)
  
  # Assemble data frame to be returned
  posterior <- data.frame(
    probabilities = oxcal_data$Sum$posterior_probabilities$probabilities,
    date_grid = oxcal_data$Sum$posterior_probabilities$dates,
    site = data[["site"]][1],
    excavation_project = data[["excavation_project"]][1])
  
  # Return data
  return(posterior)
}

# Apply modelling function to the radiocarbon dates, grouped by site name
posteriors <- radiocarbon %>% 
  group_by(site) %>%
  group_map(~ model_rcarb(.), .keep = TRUE)
  
# The data is returned as a list of lists that needs to be unpacked
rcarb_data <- do.call(rbind, posteriors) 
  
```

The Early Mesolithic, or Flake Axe Phase, is defined as lasting from c. 9400--8200 BCE (Table \@ref(tab:tab2)), and is set to start with the first recorded human presence in Norway [@damlien2018b]. Previous research has typically proposed that the Early Mesolithic is characterised by a relatively high degree of mobility, and low variation in site types and associated mobility patterns [e.g. @bjerck2008; @breivik2016; @fuglestvedt2012; but see @viken2018c]. Around the transition to the subsequent Middle Mesolithic or Microlith Phase at c. 8200 BCE, pervasive changes in blade and axe technology occur [@damlien2016; @eymundsson2018; @solheim2020], which in turn has been associated with changes in population genomics and related migration events hailing from the Eurasian steppes [@günther2018; @manninen2021]. The Microlith Phase is defined as lasting until around 7000 BCE, which is followed by the Pecked Adze Phase, characterised by a more dominating presence of non-flint macro tools and associated production waste in the assemblages [@reitan2016]. The next typological transition at c. 5600 BCE signifies the onset of the Nøstvet Adze Phase. While previously defined as having a slightly longer duration, the Nøstvet Phase has traditionally been seen as representing the onset of more varied settlement systems and stable mobility patterns [e.g. @jaksland2001; @lindblom1984]. In recent years it has been suggested that the transition to a decrease in mobility and more varied land-use patterns can be traced back to the Middle Mesolithic [@solheim2016]. The subsequent Transverse Arrowhead Phase (c. 4500--3900 BCE) is characterised by a dramatic decrease in axe finds, and the introduction of new flint projectiles [@reitan2016]. It has recently been suggested that a dispersal of people from southern Scandinavia into southern Norway takes place in this period [@eigeland2015, 379; @nielsen2021], which could follow after a preceding population decline at c. 4300 BCE [@nielsen2021, cf. @solheim2018a; @solheim2020a].

```{r tab1}

# Table. Overview of chronological framework.
Period <- c('Early Mesolithic, Fosna Phase', 'Middle Mesolithic, Tørkop Phase', 'Late Mesolithic, Nøstvet Phase', 'Late Mesolithic, Kjeøy Phase',
            'Flake Axe Phase', 'Microlith Phase', 'Pecked Adze Phase', 'Nøstvet Adze Phase', 'Transverse Arrowhead Phase')
Duration <- c("9500–8200 BCE", "8200–6300 BCE", "6300–4600 BCE", "4600–3800 BCE", "9300–8200 BCE", "8200–7000 BCE", "7000–5600 BCE", "5600–4500 BCE", "4500–3900 BCE")
framework <- c(rep("Glørstad (2010)", 4), rep("Reitan (2016)", 5))

df <- data.frame(Period, Duration, framework)


kable(select(df, -framework), booktabs = TRUE, 
      caption = "Chronological framework. Glørstad's (2010) divison of phases reflects the more traditional framework, to which Reitan (2016) has recently suggested considerable changes.", 
      col.names = NULL) %>% 
pack_rows(index = c("Glørstad (2010)" = 4, "Reitan (2016)" = 5))

```

```{r dist, fig.cap = "A) Spatial and B) temporal distribution of the sites chosen for analysis. Radiocarbon age determinations are given as the sum of the posterior density esimates. Solid lines indicate that the site has been dated with reference to relative sea-level change and typological indicators. These follow the original reports.", fig.height = 13, fig.width = 12}
# Create a bounding box around site points to limit the overview map
sitbbox <- st_bbox(site_pts)
sitbbox[1:2] <- sitbbox[1:2] - 600000
sitbbox[3:4] <- sitbbox[3:4] + 600000
boundingpoly <- st_as_sf(st_as_sfc(sitbbox))

# Reproject the bounding box to match world map, and crop the world map
# with the bounding box polygon
bound_reproj <- st_transform(boundingpoly, st_crs(countries))
mapcountries <- countries %>% 
  filter(st_intersects(., bound_reproj, sparse = FALSE))
count_reproj <- st_transform(mapcountries, st_crs(site_pts))

# Create bounding box around the sites, both for extent indicator on the
# overview map and to create basemap for the site overview.
sitbbox2 <- st_bbox(site_pts)
sitbbox2[1:2] <- sitbbox2[1:2] - 15000
sitbbox2[3:4] <- sitbbox2[3:4] + 15000
boundingpoly2 <- st_as_sf(st_as_sfc(sitbbox2))

# same as above, using the smaller bounding box
bound_reproj2 <- st_transform(boundingpoly2, st_crs(countries))
mapcountries2 <- countries %>% 
  filter(st_intersects(., bound_reproj2, sparse = FALSE))
count_reproj2 <- st_transform(mapcountries2, st_crs(site_pts))

# Assemble overview map
overview <-
  ggplot() +
  geom_sf(data = count_reproj, fill = "grey", colour = NA) +
  geom_sf(data = boundingpoly2,
          fill = NA, colour = "black", size = 1) +
  coord_sf(xlim = c(sitbbox[1], sitbbox[3]), ylim = c(sitbbox[2], sitbbox[4]),
         expand = FALSE) +
  labs(title = "A") +
  theme_bw() + theme(axis.title=element_blank(),
                     axis.text.y = element_blank(),
                     axis.text.x = element_blank(),
                     rect = element_rect(),
                     axis.ticks = element_blank(),
                     panel.grid.major = element_blank()) 

# Combine spatial point data with assemblage data (holds excavation project
# for colouring points in the maps). Set up aggregate labels. There might be
# a way to avoid having to do this manually, for example by using coordinates?
sitejoin <- right_join(site_pts, sites, by = c("LOKID" = "askeladden_id")) 

# Assemble site map. anc defined first is used for placing the scalebar,
# which required some tweaking to get right.
anc <- as.numeric(c(sitbbox2$ymin, sitbbox2$xmax))
sitemap <-
  ggplot() +
  geom_sf(data = count_reproj2, fill = "grey", colour = NA) +
  geom_sf(data = sitejoin, aes(fill = excavation_project),
          size = 2.25, shape = 21, 
          colour = "black") +
  labs(fill = "Excavation project") +
  scale_fill_manual(labels = c("E18 Bommestad-Sky", "E18 Brunlanes",
                               "E18 Rugtvedt-Dørdal", "Vestfoldbaneprosjektet"),
                    values = c("springgreen4", "royalblue2",
                                "gold1", "firebrick3")) +
  ggsn::scalebar(data = site_pts, dist = 10, dist_unit = "km", 
                 transform = FALSE, st.size = 4, height = 0.05, 
                 border.size = 0.05, st.dist = 0.07,
                 anchor = c(x = anc[2] - 8000, y = anc[1]) + 4000) +
  coord_sf(xlim = c(sitbbox2[1], sitbbox2[3]), 
           ylim = c(sitbbox2[2], sitbbox2[4]),
         expand = FALSE) +
 theme_bw() + theme(axis.title=element_blank(),
                     axis.text.y = element_blank(),
                     axis.text.x = element_blank(),
                     rect = element_rect(),
                     axis.ticks = element_blank(),
                     panel.grid.major = element_blank(),
                     legend.position = "none") +
  guides(fill = guide_legend(ncol = 2,
                             title.position = "top", title.hjust = 0.5))

# Combine radiocarbon data and reported (effectively shoreline/typology) dates,
# removing the reported date if there are relevant 14C-dates.
datedata <- full_join(sites, rcarb_data, by = "site") %>% 
  mutate(reported_start_bc = ifelse(dating_method != "c14", reported_start_bc, NA),
         reported_end_bc = ifelse(dating_method != "c14", reported_end_bc, NA))

project_colors <- c("bommestad_sky" = "springgreen4",
                  "brunlanes" = "royalblue2", 
                  "rugtvedt_dordal" = "gold1",
                  "vestfoldbaneprosjektet" = "firebrick3")

# Assemble plot of date ranges
temp_dist <- ggplot(datedata, aes(x = -mean_date, y = reorder(no, -as.numeric(no)), label = no)) +
  geom_segment(aes(x = reported_start_bc, xend = reported_end_bc,
                   yend = no, colour = excavation_project.x,
                   fill = excavation_project.x), size = 1.8) +
  geom_ridgeline(aes(x = date_grid, height = probabilities * 150,
                     fill = excavation_project.y, 
                     colour = excavation_project.x)) +
  scale_fill_manual(values = project_colors,
                    labels = c("E18 Bommestad-Sky","E18 Brunlanes",
                            "E18 Rugtvedt-Dørdal", "Vestfoldbaneprosjektet")) +
  scale_colour_manual(values = project_colors,
                    labels = c("E18 Bommestad-Sky","E18 Brunlanes",
                            "E18 Rugtvedt-Dørdal", "Vestfoldbaneprosjektet")) +
  labs(title = "B", fill = "Excavation project") +
  xlab("Cal. BCE") +
  theme_classic() +
  theme(axis.title.y = element_blank(),
        axis.ticks.y = element_blank(),
        legend.position = "bottom") +
  guides(fill =  guide_legend(title.position = "top", title.hjust = 0.5),
         colour = FALSE) 

# Call to plot (using patchwork)
(overview + sitemap) /
(temp_dist + theme(plot.margin = unit(c(0,135,0,135), "pt"))) 

```

```{r ldist, fig.cap = "A) Spatial and B) temporal distribution of the sites chosen for analysis. Radiocarbon age determintations are given as the sum of the posterior density esimates. Solid lines indicate that the site has been dated with reference to relative sea-level change and typological indicators. These follow the original reports. Site numbering follow that given in Table 2.", fig.height = 9, fig.width = 12, eval = FALSE}
temp_dist
```

A defining characteristic of the Norwegian Mesolithic is that a clear majority of the known sites are located in coastal areas [e.g. @bjerck2008]. Furthermore, these coastal sites appear to predominantly have been located on or close to the contemporary shoreline when they were in use [@åstveit2018; @breivik2018; @møller1987; @solheim2020]. In south-eastern Norway, this pattern is combined with a continuous regression of the shoreline, following from isostatic rebound [e.g. @romundset2018; @sørensen1979]. The fairly rapid shoreline displacement means that the sites tend not to have retained their strategic or ecologically beneficial shore-bound location for long periods of time [cf. @perreault2019, 47]. Consequently, the shore-bound settlement, combined with the rapid shoreline displacement has resulted in a relatively high degree of spatial separation of cumulative palimpsests, to follow the terminology of @bailey2007, while the reconstruction of the trajectory of relative sea-level change allows for a relatively good control of when these accumulation events occurred. In other parts of the world, a higher degree of spatial distribution means that while the physical separation of material can help delineate discrete events, this typically comes at the cost of losing temporal resolution as any stratigraphic relationship between the events is lost [@bailey2007].

The `r nrow(sites)` coastal sites chosen for analysis here have a relatively limited geographical distribution (Figure \@ref(fig:dist)A). The sites were excavated as part of four larger excavation projects that all took place within the last 15 years [@solheim2013b; @jaksland2014a; @melvold2014b; @reitan2014l; @solheim2017b]. The sites included in the analysis consist of all Mesolithic sites excavated in conjunction with the projects that have assemblages holding more than 100 artefacts. The institution responsible for these excavations was the Museum of Cultural History in Oslo. This has led to a considerable overlap in the archaeological personnel involved, and comparable excavation practices across the excavations. Furthermore, with these projects, major efforts were made to standardise how lithic artefacts were to be classified at the museum [@melvold2014c; @koxvold2017]. As a result, this should reduce the amount of artificial patterning in the data incurred by discrepancies in the employed systems for categorisation [cf. @clark2006; @dibble2017].

The lithic data analysed are based on the classification of the site assemblages done for the original excavation reports, and consists of `r ncol(select(sites, core:flake_retouch_other))` variables representing different debitage and tool types. The artefact data have been divided into flint and non-flint materials. Flint does not outcrop naturally in southern Norway, and is only available locally as nodules that have been transported and deposited by retreating and drifting ice [e.g. @berg-hansen1999]. This means that the distribution and quality of flint has been impacted by a diverse set of climatic and geographical factors [@eigeland2015, 46]. Thus, while flint is treated as a unified category here, the variability in quality could have been substantial. Furthermore, the various non-flint raw materials that have been lumped together have quite disparate properties, where fine-grained cryptocrystalline materials are often used as a substitute or supplement to flint, while other, coarser materials are usually associated with the production of axes and other macro tools. Given this differentiated use, these raw-material properties are expected to be reflected in the retained debitage and tool categories. An important benefit of combining all of the non-flint materials is that this reduces the dependency on whether or not these have been correctly and consistently categorised for the reports [cf. @frivoll2017]. Finally, while factors such as landscape changes through shoreline displacement can have led to variable raw-material availability at the analysed sites, their relatively constrained geographical distribution hopefully counteracts some non-behavioural sources of variation.

```{r tab2}
# Table 2. Names of analysed sites, dating method used, and reported site age.
sites %>% 
  mutate(strt_bce = reported_start_bc * -1, 
         end_bce = reported_end_bc * -1,
         dating_method = ifelse(dating_method == "shore_typo", "Shoreline/typology", "Radiocarbon")) %>% 
  select(no, site, dating_method, strt_bce, end_bce) %>% 
  kable(caption = "Analysed sites.", col.names = c("no",
                    "Site name",
                    "Dating method",
                    "Reported start (BCE)",
                    "Reported end (BCE)"),
        booktabs = TRUE, longtable = TRUE, linesep = c(""))
```

# The analysis of lithic assemblages

Studies concerned with chronological changes in the composition of lithic assemblages in southern Norway have typically had a focus on morphological variation among artefacts [e.g. @ballin1999; @bjerck1986; @reitan2016] or been concerned with technological processes associated with certain sub-categories of the site inventories, such as the production of blades or axes [e.g. @berg-hansen2017; @eymundsson2018; @damlien2016; @solheim2020]. Studies that have involved entire assemblages have either been concerned with general compositional traits such as relative frequency of various tool types and raw-materials [e.g. @breivik2016; @viken2018c; @breivik2020; @reitan2016], or involved extremely in-depth studies of technological organisation associated with a handful of assemblages [e.g. @fuglestvedt2007; @eigeland2015; @mansrud2016]. These studies are, however, based on narratively driven methods, leaving the weighting of the different variables for the final interpretations unclear. To my knowledge, only a single study dealing with the composition of Mesolithic assemblages in southern Norway has involved the use of a multivariate quantitative framework, which was employed to structure the analysis of eight Middle Mesolithic assemblages [@solheim2013a; see @glørstad2010, 145--146 for a spatial application]. In sum then, previous studies have typically either been limited to a small number of sites, to a subset of the inventories, to morphological characteristics, or to subjectively and narratively driven methods that are difficult to scale and consistently balance in the comparison of a larger number of artefact categories and assemblages.

The aim of the first of part of the analysis conducted here is to evaluate the degree to which the composition of the assemblages align with earlier studies that have employed more informal methods. This therefore assumes that the artefact categories employed in Norwegian Stone Age archaeology are, at least to a certain extent, behaviourally meaningful. However, the approach taken is also partially informed by the so-called Frison effect [@jelinek1976], which pertains to the fact that lithics studied by archaeologists can have had long and complex use-lives in which they took on a multitude of different shapes before they were ultimately discarded. Several scholars have built on this to argue that morphological variation in retouched lithics from the Palaeolithic cannot be assumed to predominantly be the result of the intention of the original knapper to reach some desired end-product, but rather that what is commonly categorised as discrete types of artefacts by archaeologists can instead in large part be related to variable degrees of modification through use and rejuvenation [e.g. @barton1991; @dibble1995; @barton2021]. Artefact categories believed not to be internally consistent and categorically exclusive have therefore been collapsed for the analysis, as their contribution as discrete analytical units could potentially be misleading.

However, for the most part we lack even a most basic understanding of what any individual lithic object in an assemblage has been used for [@dibble2017]. For example, a vast amount of artefacts defined as debitage are likely to have fulfilled the function of tools, and both debitage and formal tool types could have had various different purposes and had a multitude of shapes throughout their use-life. As a consequence, the second part of the analysis employs a suite of measures developed for the classification of lithic assemblages with these inferential limitations in mind [@barton2011; @clark2017, and below]. The logic behind these measures are founded on an understanding of technology as being organised along a continuum ranging between curated and expedient [@binford1973; @binford1977; @binford1979]. An expedient technological organisation pertains to the situational production of tools to meet immediate needs, with little investment of time and resources in modification and rejuvination, resulting in high rates of tool replacement. Curated technological organisation, on the other hand, has been related to manufacture and maintenance of tools in anticipation of future use, the transport of these artefacts between places of use, and the modification and rejuvenation of artefacts for different and changing situations.

However, following not least from the ambiguous definition first put forward by @binford1973, the theoretical definition of curation, its archaeological correlates, and behavioural implications have been widely discussed and disputed [e.g. @bamforth1986; @nash1996; @shott1996; @surovell2009, 9--13]. Still, that the distinction can offer a useful analytical point of departure if clearly and explicitly operationalised seems more or less agreed upon, and some dimensions of the concept are generally accepted. For example, although precisely how it is measured may vary, the empirical correspondent to a curated technological organisation is typically defined by high degrees of retouch, as this is commonly seen as a means of realising the potential utility of a tool---or extending its use-life---by the repeated rejuvenation and modification of edges [e.g. @bamforth1986; @dibble1995; @shott2005].

One concrete operationalisation of the terms has been forwarded by @barton1998 and collegues [e.g. @barton1999; @barton2013; @riel-salvatore2004; @riel-salvatore2007; @barton2011; @barton2014; @clark2017; @villaverde1998], who through a series of studies have shown that the relationship between volumetric density of lithics and relative frequency of retouched artefacts in lithic assemblages have a consistent negative relationship across a wide range of chronological and cultural context, ranging from Pleistocene and Holocene assemblages in Europe and Asia, to assemblages associated with both Neanderthals and modern humans [@barton2011; @riel-salvatore2008]. This relationship is taken to reflect degree of curation, and is in turn mainly to follow from the accumulated nature of land-use and mobility patterns associated with the assemblages [@barton2014]. Furthermore, the relationship between curated and expedient technological organisation has been related to the continuum defined by @binford1980 between residentially mobile foragers and logistically mobile collectors [@riel-salvatore2004; @clark2017; see also @bamforth1986; @binford1977]. Residential mobility involves the relatively frequent movement of entire groups between resource patches throughout the year, while logistic mobility entails the use of central base-camps that are moved less often and from where smaller task-groups venture on targeted forays to retrieve specific resources. A higher degree of logistic as opposed to residential mobility thus also involves a wider range of site types and associated mobility patterns [@binford1980].

Furthermore, in this model, higher degree of mobility would mean a higher dependency on the artefacts and the material people could bring with them, and dimensions such as weight, reliability, repairability, and the degree to which artefacts could be manipulated to fulfil a wide range of tasks are therefore assumed to have been factors of concern. From this it follows that the empirical expectation for short-term camps is a curated technological organisation with higher relative frequency of retouched artefacts, and a lower overall density of lithics [@clark2017]. More time spent in a single location, on the other hand, is assumed to lead to better control of raw-material availability and to allow for its accumulation. This should in turn lead to a more expedient technological organisation with reduced necessity for the conservation of lithics and extensive use of retouch. The empirical expectation for lower degree of mobility is therefore relatively high density of lithics, a low relative frequency of retouched artefacts, as well as a higher number of unexhausted cores and unretouched flakes and blades. These variables and underlying logic constitute what has been termed Whole Assemblage Behavioural Indicators [WABI, @clark2017], and is the main framework adopted here.

As these measures are argued to predominantly be determined by land-use and mobility patterns, relative frequency of chips and relative frequency of non-flint material are also included in the analysis, as these measures have also been linked to mobility patterns and is of central importance in Norwegian Stone Age archaeology [e.g. @Bicho2020; @breivik2016a; @reitan2016; @kitchel2021]---the use of local non-flint material has been taken to indicate reduced mobility and increased familiarity with local surroundings [@jaksland2001, 112; @glørstad2010, 181].

# Methodology

The exploratory approach taken here means that a wide range of combinations and transformations of variables has been explored to identify patterning in the data. While only parts of this process can sensibly be reported upon, the data and employed R programming script [@rcoreteam] is freely available as a research compendium at <https://osf.io/ehjfc/>, following @marwick2018b, allowing readers to explore and scrutinise the data and the final analytical choices made [@Marwick2017].

The `r nrow(sites)` analysed sites have been dated by reference to relative sea-level change, typology and/or radiocarbon dates (Table \@ref(tab:tab2)). Date ranges for sites based on shoreline displacement and typology are taken from the original reports and follow the evaluation done by the original excavators. Where radiocarbon age determinations believed to be associated with the lithic material are available, these have been calibrated using the IntCal20 calibration curve [@reimer2020] and subjected to Bayesian modelling using OxCal v4.4.4 [@bronkramsey2009] through the oxcAAR package [@hinz2021] for R. The only constraint imposed for the modelling of the dates was that the dates from each site are assumed to represent a related group of events through the application of the Boundary function [@bronkramsey2021]. The resulting posterior density estimates were then summed for each site. Radiocarbon data are provided in the supplementary data [see also @solheim2020a].

The first part of the analysis involves employing the method of correspondence analysis (CA), using the lithic count data as classified for the original excavation reports. As this part of the analysis partially draws on the above-mentioned Frison effect, several artefact categories have been collapsed for the CA. This for example pertains to flint tool types such as scrapers, burins, drills, knives and otherwise indeterminate artefacts with retouch. These have all been combined into the single category "small flint tools". (A full overview of the aggregated variables and their constituent parts is provided in the supplementary material). While aggregating artefact categories in this manner could potentially subsume important variation, it does also reduce the possibility that any conclusions are not simply the result of employing erroneous units of analysis.

Following the WABI and other factors associated with mobility patterns, as presented above, the variables employed in the second part of the analysis are relative frequency of secondarily worked lithics (RFSL), defined as the proportion of the assemblages constituted by retouched or ground lithics; volumetric density of lithics (VDL), defined as number of artefacts per excavated m³; relative frequency of chips, defined as the proportion of artefacts with size \< 1 mm; relative frequency of cores, the proportion of all artefacts classified as cores in the original reports; relative frequency of blanks, here defined as the proportion of all artefacts classified as flakes, blades, micro-blades or fragments; and finally relative frequency of non-flint material. Following @Bicho2020, the analysis is done using principal components analysis (PCA), leading to a shift in focus from the relative composition emphasised by the CA, to having more weight placed on patterning in the most abundant occurrences [@baxter1994, 71--77].

A note should also be made on the fact that a few variables that are sometimes invoked for the classification of sites in terms of associated mobility patterns are omitted here [e.g. @Bicho2020; @breivik2016a]. For the assemblage data itself this especially pertains to diversity in tool-types [@canessa2021], which has been omitted in light of the above-metioned Frison effect. Number of features on the sites has also been disregarded as taphonomic loss is likely to have led to a chronological bias in their preservation. Similarly, the number of activity areas, effectively number of artefact clusters, however defined, has also been disregarded. This follows most notably from the fact that the impact of post-depositional processes at Stone Age sites in Norway is arguably understudied [@jørgensen2017]. This pertains for example to bio-turbation in the form of three-throws, which can have a detrimental effect on the original distribution of artefacts, and which can be expected to have impacted several of the sites treated here [@jørgensen2017; @darmark2018e].

```{r lithics}
lithics <- sites %>%
  # Combine variables
  mutate(
    projectile = microlith + tanged_point + transverse_point + 
    single_edged_point + hognipen_point + projectile_undefined,
    small_tool = scraper + knife + burin + drill + blade_retouch + 
      microblade_retouch + chip_retouch + fragment_retouch + flake_retouch,
    macro_tool = axe + chisel, 
    macro_tool_other = axe_other + chisel_other + club_hatchet_other,
    small_tool_other = knife_other + scraper_other + drill_other + 
      microblade_retouch_other + blade_retouch_other + fragment_retouch_other +
      flake_retouch_other,
    .keep = "unused") %>%
  # Make site names the rownames
  column_to_rownames(var = "no") %>% 
  # Deselect a few of the columns not be used
  select(-excavation_project, -excavated_m3, -dating_method)

flint <- lithics %>% select(!(ends_with("other")), -grinding_slab_stone, -hammerstone)
```

```{r co_data}
# Perform correspondence analysis on the data. 'mean_age' is meant for colouring
# so is excluded here
calithics <- CA(select(lithics, -site, -mean_date, -artefact_count, -flint_count, 
                       -nonflint_count, -reported_start_bc, -reported_end_bc,
                       -askeladden_id),
                graph = FALSE)

caflint <- CA(select(flint, -site, -mean_date, -artefact_count, -flint_count, 
                       -nonflint_count, -reported_start_bc, -reported_end_bc,
                       -askeladden_id),
                graph = FALSE)

# Retrieve eigenvalues (for the text)
eigval <- get_eigenvalue(calithics)
explained_cumul_dim2 <- eigval[2,3]

# Find date to hold the central tendency date (for colouring row plot)
centdate <- (sum(range(lithics$mean_date)) / 2) / 1000
```

# Results

The general impression from the CA is that a chronological dimension accounts for a substantial amount of patterning in the data (Figure \@ref(fig:cor)). This is indicated by the general transition across the colour scale in the row plot (Figure \@ref(fig:cor)A), the fact that the two first dimensions of the CA accounts for as much as `r round(explained_cumul_dim2, 2)` % of the inertia or variance in the data, as well as the horseshoe curve or Guttman effect evident in the column plot [Figure \@ref(fig:cor)B, @baxter1994, 119--120].

The column plot reveals that the earliest sites are characterised by the flint artefact categories microburins, projectiles, as well as flint macro tools and associated debitage. These assemblages are also to a larger extent characterised by core fragments, both in flint and non-flint materials, rather than cores. The non-flint material on the earliest, or among the earliest sites, appears to be centred around the production of projectiles, as both projectiles and non-flint blades are important constituents of the assemblages at these sites. The first dimension, which is pulling some of the later sites towards the right of the plot, is mainly defined by macro tools and associated debitage in non-flint materials that are negatively correlated with more flint dominated assemblages. Site number 9, Nedre Hobekk 2, located in the upper right quadrant of the row plot represents a somewhat curious case in that it is an early assemblage characterised by axe production in metarhyolite [@eigeland2014]. However, the site had been quite heavily impacted by modern disturbances that could have impacted the lithic material and which could explain its position as an outlier in the plot [@eigeland2014]. Finally, although the sample size is quite strained and the discussion of finer chronological points might not be warranted, the first dimension does appear to be of of less importance for the absolute latest sites, as indicated by their location to the left of the plot.

As most of the variation in the data is accounted for by the dominating non-flint material in later assemblages, this suppresses and makes it difficult to discern patterns in the flint data. A second CA was therefore run excluding the non-flint material (Figure \@ref(fig:flintcor)). While not as substantial, there is clear temporal patterning in the flint data as well. This is most marked for the earliest sites which are pulled away from the main cluster, as projectiles, microburins, macro tools and debitage from their production characterises these sites. Slightly younger sites appear more impacted by core fragments and blades. The temporal transition in the main cluster is not as marked, but clearly present, and is driven by a larger proportion of blades, flakes and small tools in the earliest assemblages of the cluster, which is opposed to chips, fragments and partly micro-blades.

```{r cor1, fig.cap = "Correspondence analysis using artefact count data.", fig.height = 8, fig.width = 10, eval = FALSE}
# Plot with site names tags (probably most immediately relevant for an audience 
# familiar with the sites)
fviz_ca_row(calithics, col.row = "black",
            fill = lithics$mean_date / 1000, title = "A",
                     repel = TRUE, shape = 21, pointsize = 2.9) +
  scale_fill_gradient2(name = "Mean age kyr BCE", low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 
```

```{r cor, fig.cap = "Correspondence analysis using the artefact count data. A) Row plot, B) Column plot.", fig.height = 13}
# Plot sites
plt1 <- fviz_ca_row(calithics, col.row = "black",
                    fill = lithics$mean_date / 1000, title = "A",
                     repel = TRUE, shape = 21, pointsize = 2.9) +
  scale_fill_gradient2(name = "Mean age kyr BCE", low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 

# Plot variables
plt2 <- fviz_ca_col(calithics, col.col = "contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), repel = TRUE,
             title = "B") +
  labs(colour = "Contribution to total inertia") +
  theme(legend.position = "bottom") 

# Plot sites for the flint data
plt3 <- fviz_ca_row(caflint, col.row = "black", fill = lithics$mean_date / 1000,
                    title = "A",
                     repel = TRUE, shape = 21, pointsize = 2.9) +
  scale_fill_gradient2(name = "Mean age kyr BCE", low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 


 

# Variables for the flint data
plt4 <- fviz_ca_col(caflint, col.col = "contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), repel = TRUE,
             title = "B") +
  labs(colour = "Contribution to total inertia") +
  theme(legend.position = "bottom") 

plt1 /
plt2 

```

```{r flintcor, fig.height = 13, fig.cap = "Correspondence analysis using the flint data. A) Row plot, B) Column plot."}
plt3 /
plt4 
```

Moving on to the PCA of measures that have been linked to mobility, some of the variables with severely skewed distributions were initially transformed (Figure \@ref(fig:cor-plot)). Figure \@ref(fig:pca-analysis) displays the resulting PCA. There is a general temporal transition from the upper left to the bottom right of the plot. The second dimension is mainly defined by a negative correlation between the VDL and RFSL (Figure \@ref(fig:var-contrib)). Almost orthogonal to this is the strong negative correlation between relative frequency of chips and blanks. While there is a slight tendency for blanks to be more associated with younger sites, frequency of chips appears to be largely independent of time. However, this almost suspiciously strong negative correlation can perhaps have a practical explanation. Seeing as the frequency of non-flint material is positively correlated with blanks and negatively correlated with chips (Figure \@ref(fig:cor-plot)), one explanation to this pattern could be that smaller non-flint pieces are simply more difficult to identify and separate from naturally fragmented stone during excavation and classification. This could conceivably have led to an over-representation of blanks as compared to chips in assemblages with a high proportion of non-flint material. While this is not necessarily the entire explanation, this does make it difficult to place much analytical weight on this pattern. Relative frequency of cores is not especially impactful in the PCA, and appears to be independent of the temporal dimension as well. That is not to say that cores may not be indicative of or related to mobility patterns, but to get at this may require further analysis beyond their simple classification as cores [@kitchel2021].

Thus, while some secondary expectations of the WABI do not seem to apply to the present material, it is difficult to say to what degree this is caused by idiosyncrasies in the Norwegian system for classification of lithics and properties of the lithic material itself. The relationship between VDL and RFSL does correspond to the model and follows a clear temporal trend that is also correlated with the increased use of local raw material. Thus, if the relationship between VDL and RFSL is accepted as a proxy for curation, and is related to land-use and mobility patterns, these findings would be in line with previous research into the Mesolithic of Norway, indicating that earlier sites are associated with higher degree of mobility than sites from later phases [e.g. @bergsvik2001; @bjerck2008; @glørstad2010; @jaksland2001]. To explore this proposition further, these two variables are subjected to more detailed scrutiny below.

```{r pcadata}
# Tried to do this to avoid having to type the variable names into both mutate()
# and select(). The general syntax select(-(vector_of_variable_names)) worked,
# but not: mutate(new_varaible = sum(vector_of_variable_names) / artefact_count)
blanks_flint <- c("blade", "microblade", "fragment", "flake")

blanks_lithics <- c(blanks_flint, "flake_other", "fragment_other", 
                     "blade_other",  "microblade_other")

secondary_flint <- c("axe_debitage", "axe", "chisel", "microlith", 
                    "tanged_point", "transverse_point", "single_edged_point",
                    "hognipen_point", "projectile_undefined", "microburin",
                    "scraper", "knife", "burin", "drill", "blade_retouch",
                    "microblade_retouch", "chip_retouch", "fragment_retouch",
                    "flake_retouch")

secondary_lithics <- c(secondary_flint, "axe_other", "axe_debitage_other",
                       "chisel_other", "club_hatchet_other", 
                       "grinding_slab_stone", "projectile_other", 
                       "knife_other", "scraper_other", "drill_other", 
                       "microblade_retouch_other", "blade_retouch_other",
                       "fragment_retouch_other", "flake_retouch_other")

lithics2 <- sites %>% 
  select(-beach_flint_flint_nodule, -hammerstone, -excavation_project,
          -askeladden_id) %>% 
  # The reason for not using .keep below is to 
  # retain artefact_count
  mutate(chip_freq =  sum(chip, chip_other) / artefact_count,
         core_freq = sum(core, core_other) / artefact_count,
         blanks_freq = sum(blade, microblade, flake, flake_other, fragment,
            fragment_other, blade_other,  microblade_other) / artefact_count,
         secondary_freq =  sum(axe_debitage, axe, chisel, 
                microlith, tanged_point, transverse_point, single_edged_point,
                hognipen_point, projectile_undefined, microburin, scraper, 
                knife, burin, drill, blade_retouch, microblade_retouch, 
                chip_retouch, fragment_retouch, flake_retouch, axe_other,
                axe_debitage_other, chisel_other, club_hatchet_other, 
                grinding_slab_stone, projectile_other, knife_other,
                scraper_other, drill_other, microblade_retouch_other, 
                blade_retouch_other, fragment_retouch_other,
                flake_retouch_other) / artefact_count,
         nonflint_freq = nonflint_count / artefact_count,
         lithic_dens = artefact_count / excavated_m3) %>%
  select(-blanks_lithics, -secondary_lithics, -excavated_m3, -artefact_count,
         -flint_count, -nonflint_count, -core, -core_fragment, -chip, 
         -chip_other, -core_other, -core_fragment_other) %>% 
  column_to_rownames("no")


# Repeat but for flint only
flint2 <- sites %>% 
  select(-beach_flint_flint_nodule, -hammerstone, -excavation_project, 
         -reported_start_bc, -reported_end_bc, -askeladden_id) %>% 
  select(!ends_with("other")) %>% 
  mutate(chip_freq =  sum(chip) / artefact_count,
         core_freq = sum(core) / artefact_count,
         blanks_freq = sum(blade, microblade, flake, fragment) / artefact_count,
         secondary_freq =  sum(axe_debitage, axe, chisel, 
                microlith, tanged_point, transverse_point, single_edged_point,
                hognipen_point, projectile_undefined, microburin, scraper, 
                knife, burin, drill, blade_retouch, microblade_retouch, 
                chip_retouch, fragment_retouch, flake_retouch) / artefact_count,
         flint_dens = flint_count / excavated_m3) %>%
  select(-blanks_flint, -secondary_flint, -excavated_m3, -artefact_count,
         -flint_count, -nonflint_count, -grinding_slab_stone, -core, 
         -core_fragment, -chip, dating_method) %>% 
  column_to_rownames("no")

# VDL and RFSL for all lithics
wabicor <- cor(log10(lithics2$lithic_dens), log10(lithics2$secondary_freq))

# Langangen Vestgård 2 does not have any retouched flint
wabiflint <- filter(flint2, secondary_freq > 0)
wabicorflint <- cor(log10(wabiflint$flint_dens), log10(wabiflint$secondary_freq))

# Correlation with mean site date, all lithics
secfreqcor <- cor(lithics2$mean_date, lithics2$secondary_freq)
denscor <- cor(lithics2$mean_date, lithics2$lithic_dens)

# Correlation with mean site date, flint
secfreqcorflint <- cor(wabiflint$mean_date, wabiflint$secondary_freq)
denscorflint <- cor(wabiflint$mean_date, wabiflint$flint_dens)

```

```{r cor-plot, fig.cap = "Correlation matrix showing transformation of skewed variables for the PCA. The mean age of the sites has also been included to visualise overall temporal trends. Cells below the diagonal display the bivariate distributions with a fitted OLS-regression. The cells above the diagonal display and are coloured by the corresponding Pearson's correlation coefficient.", fig.height = 9.5, fig.width = 10}
# Transform the skewed variables - sqrt() is used where there are zero values,
# and seems to provide an adequate result.
lithicstr <- lithics2 %>%
  select(-site) %>% 
  # Transform skewed variables and reorder
  mutate(
         "log10(lithic_dens)" = log10(lithic_dens),
         "log10(secondary_freq)" = log10(secondary_freq),
         "core_freq^(1/3)" = core_freq^(1/3),
         "nonflint_freq^(1/3)" = nonflint_freq^(1/3), .keep = "unused") %>% 
  relocate("mean_date",
    "log10(lithic_dens)", "nonflint_freq^(1/3)", "blanks_freq", "log10(secondary_freq)",
    "chip_freq", "core_freq^(1/3)" 
  )

corr_plot(select(lithicstr, -reported_start_bc, -reported_end_bc, -dating_method))
```

```{r pca-analysis, fig.cap = "PCA using variables that have been related to mobility patterns. Note that details on the transformation of the variables has been left out of the plot for clarity, but follow those given in Figure 4.", fig.height = 8}
# Rename the transformed variables again to avoid clutter in the plot. 
# Specify in figure caption that the transformed variables are used.
lithicspca <- lithicstr %>% 
  rename(
   lithic_dens = "log10(lithic_dens)",
   secondary_freq = "log10(secondary_freq)",
   core_freq = "core_freq^(1/3)",
   nonflint_freq = "nonflint_freq^(1/3)"
  )


pcalithics <- PCA(select(lithicspca, -reported_start_bc, -dating_method,
                         -reported_end_bc, -mean_date),
                  scale.unit = TRUE, graph = FALSE)

fviz_pca(pcalithics, fill.ind = lithicspca$mean_date / 1000, 
          repel = TRUE, col.var = "black", pointshape = 21,  pointsize = 2.9,
         title = "") + 
  scale_fill_gradient2(name = "Mean age kyr BCE",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 

```

```{r var-contrib, fig.cap = "Contribution of variables to the first two components of the PCA. The dotted red line indicates the expected contribution from each variable given a uniform distribution of impact.", fig.height = 3}
# The plots below investigates the contribution of the variables to the
# components. The code has in large part been taken from 
# Bicho & Cascalheira (2020).
var <- get_pca_var(pcalithics)
dim1 <- fviz_contrib(pcalithics, choice = "var", axes = 1,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 1")
dim2 <- fviz_contrib(pcalithics, choice = "var", axes = 2, 
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 2")
dim3 <- fviz_contrib(pcalithics, choice = "var", axes = 3,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 3")
dim4 <- fviz_contrib(pcalithics, choice = "var", axes = 4,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 4")

# Patchwork for arranging plots
(dim1 | dim2) 
#(dim3 | dim4)
```

```{r var_cor, fig.cap = "Plots showing the correlation between the variables", eval = FALSE}
plt1 <- fviz_pca_var(pcalithics,
                  col.var = "black",
                  title = "Correlation plot: Component 1/Component 2",
                  repel = TRUE
                  )
plt2 <- fviz_pca_var(pcalithics,
                  col.var = "black",
                  axes = 3:4,
                  title = "Correlation plot: Component 3/Component 4",
                  repel = TRUE
                  )

plt1 + plt2
```

There is a strong negative correlation between the two variables (*r =* `r round(wabicor, 2)`) and a general tendency for younger sites to be associated with a higher VDL and a lower RFSL than older sites (Figure \@ref(fig:wabi)A). The linear correlation is stronger between the mean site age and RFSL (*r =* `r round(secfreqcor, 2)`), than between mean site age and VDL (*r =* `r round(denscor, 2)`). Variable non-flint availability and workability has also been suggested to potentially impact these dimensions [cf. @manninen2014], but while the negative correlation is slightly less marked when only the flint data is considered (*r =* `r round(wabicorflint, 2)`), the general pattern is the same (Figure \@ref(fig:wabi)B). The relationship between mean site age and relative frequency of secondarily worked flint is even stronger (*r =* `r round(secfreqcorflint, 2)`), but as indicated by the more spread out distribution along the x-axis, the volumetric density of flint is not temporally contingent (*r =* `r round(denscorflint, 2)`). As was also indicated by the CA, this follows from the fact that non-flint materials make up a higher share of the assemblages for some of the later Mesolithic sites, and is a point returned to below where the temporal dimension of the relationship between VDL and RFSL is explored further.

```{r wabi, fig.cap = "Relative frequency of secondarily worked lithics plotted against the volumetric density of artefacts for A) All lithics, B) Flint. The logarithm is taken to base 10 on all axes.", fig.height = 5, fig.width = 10}

w1 <- ggplot(lithics2, aes(lithic_dens, secondary_freq * 100, 
                     fill = mean_date / 1000)) + 
  geom_point(shape = 21, size = 3) +
  geom_smooth(method = "lm", col = "black", se = FALSE) +
  labs(title = "A",
       x = "Volumetric density of lithics (log10)", 
       y = "% secondarily worked lithics (log10)") +
  scale_fill_gradient2(name = "Mean age kyr BCE",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  scale_y_log10() +
  scale_x_log10() +
  theme_classic() +
  theme(legend.position = "bottom") 

w2 <- 
  ggplot(flint2, aes(flint_dens, secondary_freq * 100, 
                     fill = mean_date / 1000)) + 
  geom_point(shape = 21, size = 3) +
  geom_smooth(method = "lm", col = "black", se = FALSE) +
  labs(title = "B", 
       x = "Volumetric density of flint (log10)", 
       y = "% secondarily worked flint (log10)") +
  scale_fill_gradient2(name = "Mean age kyr BCE",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  scale_y_log10() +
  scale_x_log10() +
  theme_classic() +
  theme(legend.position = "bottom") 


w1 | w2
```

To get more directly at this temporal trend, a curation index based on VDL and RFSL was devised by first performing a min-max normalisation of the two variables, scaling them to take on values between 0 and 1. The value for artefact density was then made negative to reflect its relationship with degree of curation. The mean was then found for each site on these two normalised values. To account for the temporal uncertainty associated with the dating of the sites, a simulation-based approach was also adopted [e.g. @crema2012; @orton2017]. A LOESS curve was fit to the curation index and site age for each simulation run, where the age of each site was drawn as a single year from their respective date ranges as provided in Figure \@ref(fig:dist). For sites with radiocarbon age determinations the dates were drawn from the summed posterior density estimates, while ages for sites dated with reference to relative sea-level change and typology were drawn uniformly from the associated date range (Figure \@ref(fig:simplot)). This simulation was repeated 1000 times. Disregarding the edge-effects at either end of the plot, the general tendency is a relatively high degree of curation among the earlier sites, followed by a marked drop around 8000 BCE. This has stabilised by around 7000 BCE and remains stable for the rest of the Mesolithic. The variation in degree of curation is also markedly higher after 8000 BCE. Figure \@ref(fig:simplot)B displays the result of running the same procedure on the flint data. The general pattern follows the same trajectory, but the result for some individual sites is noticeably different.

```{r index}
# Create curation index
minmax <- lithics2 %>%  
  mutate(dens =  ((lithic_dens - min(lithic_dens)) / (max(lithic_dens) - min(lithic_dens))),
         secondary = ((secondary_freq - min(secondary_freq)) / (max(secondary_freq) - min(secondary_freq))))

minmaxflint <- flint2 %>% 
  mutate(dens =  ((flint_dens - min(flint_dens)) / (max(flint_dens) - min(flint_dens))),
         secondary = ((secondary_freq - min(secondary_freq)) / (max(secondary_freq) - min(secondary_freq))))

indexdata <- minmax %>% 
  rowwise() %>% 
  mutate(index = mean(c(dens * -1, secondary)))

indexdataflint <- minmaxflint %>% 
  rowwise() %>% 
  mutate(index_flint = mean(c(dens * -1, secondary)))


indexdata$index_flint <- indexdataflint$index_flint

# Curation index plot simply using mean site age (not in use)
w3 <- ggplot(indexdata, aes(x = mean_date, y = index)) + 
  geom_point() +
  labs(title = "C",
       x = "Mean date cal. BCE",
       y = "Curation index") +
  geom_smooth(method = "loess", col = "red") +
  theme_classic()  + 
  ggrepel::geom_label_repel(aes(label = site),box.padding   = 0.35, 
                  point.padding = 0.5,
                  segment.color = 'grey50') 

w4 <- ggplot(indexdata, aes(x = mean_date, y = index_flint)) + 
  geom_point() +
  labs(title = "C",
       x = "Mean date cal. BCE",
       y = "Curation index") +
  geom_smooth(method = "loess", col = "red") +
  theme_classic()  + 
  ggrepel::geom_label_repel(aes(label = site),box.padding   = 0.35, 
                  point.padding = 0.5,
                  segment.color = 'grey50') 

```

```{r simage, cache = TRUE}

agedata <- full_join(indexdata, rcarb_data, by = "site") 

# Define function to draw sample from either 14C probability distribution,
# or uniform typological/displacement-inferred date range.
sample_date <- function(site){
  
  # If the dating method is 14C, draw a sample using the associated posterior
  # pdf
  if(site["dating_method"][1,] == "c14"){
    samplingframe <- list(x = site[["date_grid"]], y = site[["probabilities"]])
    sdate <- with(samplingframe, sample(x, size = 1, prob = y))
  # If not, draw a random year from the reported date range (uniform probability)
  } else {
    sdate <- sample(as.integer(site["reported_start_bc"]):as.integer(site["reported_end_bc"]), 1)
  }
  # Return sampled date with site name as rowname. 
  sdate <- data.frame(sdate)
  row.names(sdate) <- site[["site"]][1]
  return(sdate)
}

# Specify number of simulation runs
nsim <- 1000

# Create data frame to hold simulation results.
results <- data.frame(matrix(NA, ncol = nsim, nrow = nrow(sites))) 
# Insert the curation index value for each site
index_values <- agedata %>% 
  group_by(site) %>% 
  slice(1) %>% 
  ungroup() %>% 
  select(index, index_flint) %>% 
  c()

results[,"index"] <- index_values$index
results[,"index_flint"] <- index_values$index_flint

# Simulation loop
for (i in 1:nsim){
  agesamples <- agedata %>% 
    group_by(site) %>% 
    group_map(~ sample_date(.), .keep = TRUE) %>% 
    do.call(rbind, .)
  
  results[,i] <- agesamples
  row.names(results) <- row.names(agesamples)
}
```

```{r simplot, fig.cap = "Temporal variation in the curation index for A) All lithics, and B) Flint. The temporal uncertainty is handled by means of a simulation approach where the site ages are drawn from their respective age determination probability density functions given in Figure 1B. A LOESS curve has been fit to the distribution for each of the 1000 simulation runs. Each simulation run is plotted with some transparency. Sites mentioned in the text are given colour.", fig.height = 14, fig.width = 12}

# Apply pivot_longer to make the results amenable to plotting
resultslong <- results %>% 
  rownames_to_column(var = "site") %>% 
  pivot_longer(
    cols = starts_with("X"),
    names_to = "sim", 
    values_to = "age"
  )

# Create column to hold whether site is to be coloured specifically in the plots
# (pertains to sites discussed in the text)
sitelabs <- c("Hovland 3", "Langangen Vestgård 1", "Hegna vest 4",
              "Vallermyrene 4", "Gunnarsrød 6b", "Prestemoen 1")

resultslong <- resultslong %>% 
  mutate(site_col = ifelse(site %in% sitelabs, site, "Other sites"))

# Call to plot, grouping loess fits by simulation runs
i1 <- ggplot(resultslong, aes(x = age, y = index, colour = site_col)) + 
  geom_smooth(aes(group = sim), method = "loess", fill = "grey", col = "black",
              alpha = 0.05, se = TRUE) +
  geom_point(size = 0.5, alpha = 0.01) +
  scale_color_manual(name = NULL, breaks = c("Langangen Vestgård 1", 
                                             "Hegna vest 4","Gunnarsrød 6b",
                                             "Prestemoen 1",  "Hovland 3",
                                             "Vallermyrene 4", "Other sites"),
                    values = c("Langangen Vestgård 1" = "red",
                               "Hegna vest 4" = "blue",
                               "Gunnarsrød 6b" = "violet",
                               "Prestemoen 1" = "darkorange",
                               "Hovland 3" = "green",
                               "Vallermyrene 4"  = "cyan1", 
                               "Other sites" = "black"),
                     guide = guide_legend(override.aes = list(size = 3,
                                                              alpha = 1))) +
  scale_x_continuous(breaks = c(seq(-9000,-4000, 1000))) +
  labs(title = "A", x = "Cal. BCE", y = "Curation index (All lithics)") +
  theme_classic() +
  theme(legend.position = "none",
        text=element_text(size=16))

i2 <- ggplot(resultslong, aes(x = age, y = index_flint, colour = site_col)) + 
  geom_smooth(aes(group = sim), method = "loess", fill = "grey", col = "black",
              alpha = 0.05, se = TRUE) +
  geom_point(size = 0.5, alpha = 0.01) +
  scale_color_manual(name = NULL, breaks = c("Langangen Vestgård 1", 
                                             "Hegna vest 4","Gunnarsrød 6b",
                                             "Prestemoen 1",  "Hovland 3",
                                             "Vallermyrene 4", "Other sites"),
                    values = c("Langangen Vestgård 1" = "red",
                               "Hegna vest 4" = "blue",
                               "Gunnarsrød 6b" = "violet",
                               "Prestemoen 1" = "darkorange",
                               "Hovland 3" = "green",
                               "Vallermyrene 4"  = "cyan1", 
                               "Other sites" = "black"),
                     guide = guide_legend(override.aes = list(size = 5,
                                                              alpha = 1))) +
  scale_x_continuous(breaks = c(seq(-9000,-4000, 1000))) +
  labs(title = "B", x = "Cal. BCE", y = "Curation index (Flint)") +
  theme_classic() +
  theme(legend.position = "bottom",
        text=element_text(size=16))

  i1 /
  i2
```

# Discussion

The results of the CA appear to align well with previous research [e.g. @solheim2017c, with references]. In the flint material the earliest sites are separated from the rest primarily based on the presence of macro tools, microburins, projectiles, and, for slightly younger sites, core fragments and blades [cf. @bjerck2017; @breivik2018; @fuglestvedt2009; @jaksland2014b; @damlien2018b]. The importance of the latter two can be associated with the blade technology that is introduced with the Middle Mesolithic, characterised by blade production from conical and sub-conical cores with faceted platforms that involves the removal of core tablets and rejuvenation flakes [@damlien2016]. When it comes to the non-flint material, projectiles are to a larger extent a property of the earlier sites than later ones. The use of metarhyolite for the production of axes is present at some earlier sites in addition to the previously mentioned Nedre Hobekk 2, and the production of non-flint hatches and core axes is introduced in the Microlith Phase [@eymundsson2018; @jaksland2014b; @reitan2016]. However, in agreement with the literature, this is evidently not as prominent a part of these assemblages.

The flint material of the later sites are to larger extent characterised by micro-blades, which corresponds to the transition to micro-blade production from handle cores [e.g. @solheim2020]. A more fragmented flint material, as indicated by the relative importance of flint chips and fragments, is also a previously noted property of some later Mesolithic, as well as early Neolithic sites [e.g. @fossum2017; @stokke2018a]. The most defining material for the later sites, however, is non-flint macro tools and associated debitage, which is dominating some of these assemblages. It was noted above that this material does not seem to impact the latest sites, which would indicate that specialised axe production sites disappear towards the end of the Mesolithic, a notion that would be in line with previous suggestions [e.g. @glørstad2011; @reitan2016].

One implication of the fact that the employed artefact categories are so clearly capturing a temporal component could be that the aggregation of artefact categories might have been overly conservative. However, it is also evidently clear, in the words of @kruskal1971 [22], that 'time is not the only dimension'. The results of the CA do most certainly correspond to more pervasive cultural change than a purely typo-chronological development of artefact morphology, which is also made evident by some significant deviances from the overall pattern. Unpicking and aligning these patterns with any specific behavioural and technological dimensions using the coarse CA results is, however, another task entirely. This follows most clearly from the fact that for the most part we do not know what individual lithic objects in the assemblages have been used for, leaving the behavioural and social significance of the employed units of analysis unclear. The results of the CA can, however, be used in conjunction with the part of the analysis that has attempted to get at more specific behavioural dimensions to nuance or explain discrepancies in this data.

The curation index has relatively high values until some time before 8000 BCE, before it drops and stabilises around 7000 BCE. This pattern is evident in both the flint data and when all lithics are treated in aggregate. Furthermore, the increased variation in degree of curation after around 8000 BCE could indicate that these sites were associated with a more varied mobility pattern. The five sites that have values on the curation index below c. -0.25 could in this perspective have predominantly functioned as base-camps within a logistic settlement pattern. That these assemblages reflect stays of a longer duration was suggested for all five sites in the original reports [@solheim2013; @carrasco2014; @persson2014; @eigeland2017], with the exception of for Vallermyrene 4, which was argued to be a specialised axe production site, not necessarily associated with lower degrees of mobility [@eigeland2014b]. This highlights a possible issue pertaining to raw-material variability, as the coarse non-flint material used for the production of axes generally results in a relatively large amount of waste per produced tool, possibly skewing the curation index when compared to assemblages dominated by flint. Referring back to the CA, the difference is most marked for the sites in the later part of the Mesolithic where non-flint material become more dominating parts of the assemblages. As can be seen in Figure \@ref(fig:simplot)B, the degree of curation is markedly higher for both Gunnarsrød 6b and Vallermyrene 4 when the non-flint material is excluded, although they remain more expedient than that of contemporary assemblages. Thus, the degree of expediency for assemblages dominated by non-flint might be somewhat exaggerated when the non-flint material is included, while its exclusion would likely lead to its underestimation. One possible approach could be to weigh the curation index by the proportion of non-flint material in the assemblages. This is not explored further here, however, as the overall tendencies are relatively robust to this effect.

Another case also worth commenting on is Langangen Vestgård 1, which, on the grounds of an overall large number of artefacts and the possible presence of a dwelling structure was argued to reflect a more permanent site location in the original report [@melvold2014]. However, the relatively high value on the curation index could mean that the site reflects the aggregation of stays which predominantly have been of a comparable duration to those on contemporary sites, while the possible dwelling structure, if taken as an indication of longer stays, could in this perspective represent a remnant from one or a few visits of longer duration that constitute a smaller fraction of the use-life of the site as a whole [cf. @barton2014].

While there are certainly nuances in the material that might lead one to question the applicability of the VDL and RFSL measures for any individual site, the overall pattern for curation does appear relatively robust. The curation index is relatively high and uniform until some time before 8000 BCE. This corresponds well with the view that the Early Mesolithic is characterised by a high and uniform degree of mobility. This is followed by a marked increase in expedience, which has stabilised by around 7000 BCE. Again, this corresponds well with the employed chronological framework. Referring back to the demographic changes that are to take place around this transition, the Microlith phase could thus represent a period where migrating people and new living practices were propagating through societies in south-eastern Norway---a process that in light of the curation data would have concluded around 7000 BCE.

The curation index then remains stable for the rest of the Mesolithic. This suggests that the transition to mobility patterns traditionally ascribed to the Nøstvet Phase can indeed be traced back to the Microlith Phase [cf. @solheim2016]. The continued stability of the curation index could also indicate that the demographic changes suggested to take place in the Transverse Arrowhead Phase are not related to major shifts in land-use and mobility patterns. However, it is worth highlighting the strained sample size for the later parts of the Mesolithic, which could mean that the effect is simply missed.

As it stands, the main hypotheses resulting from the present analysis would be that settlement patterns in the earliest parts of the Mesolithic were characterised by relatively high and uniform degrees of mobility, which then drop before levelling off at around 7000 BCE. These then remain relatively stable throughout the rest of the period, despite variation pertaining to other aspects of the lithic inventories, as evidenced by the CA. The fall in curation levels and parallel increase in variation would seem to correlate well with a transition from a predominantly residential to logistical settlement system [@binford1980]. This indicates, in turn, that the measures represent an empirical link between technological organisation and economic behaviour and mobility patterns [@riel-salvatore2004]. 

# Conclusion

The results of the CA align well with results of previous research in south-eastern Norway, indicating that meaningful chronological patterning is associated with the employed artefact categories. These tendencies are already well-established when it comes to the formal tool types and some debitage categories, but have been given less focus in light of entire assemblages. Precisely what behavioural implication the development in the occurrences of the tool and debitage categories have are less clear, but appears to follow a different and more complex development over time than that of curation, as operationalised here.

The temporal trends associated with the curation index corresponds surprisingly well with trajectories of cultural development previously suggested in the literature, and does therefore, in my view, suggest that shifts in land-use and mobility patterns are the main drivers behind this empirical pattern---in line with the framework of @barton2011. Another perspective would be that this is not surprising at all [cf. @kuhn2015, 14], and that the previously demonstrated relevance of these measures across a wide range of contexts points to their pervasive relevance for the organisation of lithic technology, and, therefore, that there should be little reason to think Mesolithic south-eastern Norway should be any different. However, the conclusion that these these measures apply to and appear to capture the dimensions of interest in a relatively controlled empirical setting, reached by means of an exploratory analysis can only constitute a first analytical step. As @elster2015 [12] has pointed out, the human mind seems to have a propensity to settle for an explanation that *can* be true, as soon as this has been reached. This, however, can only constitute the absolute minimum of what is required of a proposed explanation. Subsequent steps should be to probe and challenge this explanatory framework, also in light of alternative hypotheses. The empirical relationship does nonetheless hold great potential for large scale comparative studies in Mesolithic Scandinavia and beyond. Furthermore, the curation index was here simply narratively associated with the most immediate chronological trends emphasised in the literature concerned with the Mesolithic of south-eastern Norway. The explicit quantification does, however, offer the possibility to conduct formal comparisons with a wide range of environmental, demographic and cultural dimensions across multiple scales of analysis.

\newpage

# References

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

::: {#refs}
:::

\newpage

# Supplementary material A. Radiocarbon dates.

```{r supp1}
# Supplementary table of radiocarbon dates

select(radiocarbon, -excavation_project) %>% 
  kable(booktabs = TRUE, longtable = TRUE,
      col.names = c("Site name", "Material", "Lab code", "C14-age", "Error"),
      linesep = c(""))
```

# Supplementary material B. Aggregation of variables for the correspondence analysis.

```{r supp2}
# Most of the code for assembling the Sankey plot has been taken directly from 
# various walkthroughs at https://www.r-graph-gallery.com

# Create two columns: old and new variable names
links <- data.frame(value = 1,
        categories = names(sites %>% select(core:flake_retouch_other))) %>% 
  mutate(new_categories = ifelse(categories %in% c("microlith", "tanged_point",
                                 "transverse_point", "single_edged_point", 
                                 "hognipen_point", "projectile_undefined"), 
                                 "projectile",
                          ifelse(categories %in% c("scraper", "knife", "burin",
                                 "drill", "blade_retouch", "microblade_retouch",
                                 "chip_retouch", "fragment_retouch", 
                                 "flake_retouch"), "small_tool",
                          ifelse(categories %in% c("axe", "chisel"),
                                 "macro_tool", 
                          ifelse(categories %in% c("axe_other", "chisel_other",
                                 "club_hatchet_other"), "macro_tool_other", 
                          ifelse(categories %in% c("knife_other", 
                                 "scraper_other", "drill_other", 
                                 "microblade_retouch_other", 
                                 "blade_retouch_other", 
                                 "fragment_retouch_other",
                                 "flake_retouch_other"), "small_tool_other",
                                 paste0(categories, " ")))))))

# Set up nodes and links for the plot
nodes <- data.frame(
  name=c(as.character(links$categories), 
         as.character(links$new_categories)) %>% unique()
)

links$IDsource <- match(links$categories, nodes$name)-1 
links$IDtarget <- match(links$new_categories, nodes$name)-1 
nodes$group <- as.factor(c("none"))
links$group <- as.factor(links$new_categories)

# Specify colours for the plot (this can be assembled using a combination of 
# e.g. unique(links$new_connection), rep() and paste(), but I couldn't be 
# bothered so I just copy+pasted and set it up manually).
my_colour <-'d3.scaleOrdinal() .domain(["core", "core_fragment", "blade", "microblade", "chip", "fragment", "flake", "axe_debitage", "macro_tool", "projectile", "microburin", "small_tool", "beach_flint_flint_nodule", "macro_tool_other", "axe_debitage_other", "grinding_slab_stone", "projectile_other", "small_tool_other", "hammerstone", "flake_other", "fragment_other", "chip_other", "blade_other", "microblade_other", "core_other", "core_fragment_other,"]) .range(["lightgrey", "lightgrey", "lightgrey", "lightgrey", "lightgrey", "lightgrey", "lightgrey", "lightgrey", "#ff8086", "#79d49f", "lightgrey", "#8eb8fa", "lightgrey", "#a88c7d", "lightgrey", "lightgrey", "lightgrey", "#ffee8c",  "lightgrey", "lightgrey", "lightgrey", "lightgrey", "lightgrey", "lightgrey", "lightgrey", "lightgrey"])'


# Create plot
sn <- sankeyNetwork(Links = links, Nodes = nodes,
              Source = "IDsource", Target = "IDtarget",
              NodeID = "name", Value = "value", colourScale = my_colour,
              sinksRight = FALSE, LinkGroup = "new_categories", 
              NodeGroup="group", nodeWidth = 12, nodePadding = 7, fontSize = 10)

# This has to be saved as html widget and then retrieved as a pdf or png using
# webshot.
htmlwidgets::saveWidget(sn, here::here('analysis/figures/sn1.html'))
webshot::webshot(here::here('analysis/figures/sn1.html'), 
                 here::here('analysis/figures/sn1.pdf'), delay = 0.2)
```

<!-- \newpage -->

<!-- ### Colophon -->

<!-- This report was generated on `r Sys.time()` using the following computational environment and dependencies: -->

<!-- ```{r colophon, cache = FALSE} -->

<!-- # which R packages and versions? -->

<!-- if ("devtools" %in% installed.packages()) devtools::session_info() -->

<!-- ``` -->

<!-- The current Git commit details are: -->

<!-- ```{r} -->

<!-- # what commit is this file at?  -->

<!-- if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())   -->

<!-- ``` -->
