---
title: "Exploring the composition of lithic assemblages in Mesolithic south-eastern Norway"
author:
  - Isak Roalkvam:
      email: isak.roalkvam@iakh.uio.no
      institute: [UiO]
      correspondence: true
institute:
  - UiO: University of Oslo
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::html_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style
---

<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

<!-- The following code chunk defines some general settings how code chunks should behave. -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.width = 9,
  fig.path = "../figures/",
  dpi = 300
)
```

```{r libraries, eval = TRUE}
library(tidyverse)
library(patchwork)
library(gt)
library(FactoMineR)
library(factoextra)
library(sf)
```

```{r get-data, eval = TRUE}
assemblages <- read.csv(here::here('analysis/data/raw_data/assemblage_data.csv'))

```

<!-- Here's some example analysis code: -->

# Introduction

Previous studies of lithic artefacts in Norway have typically had a focus on chronological trends associated with formal tool types [@reitan2016], involved refit-studies of the entirety of individual assemblages [@skar1986], or in-depth analyses concerned with technological processes associated with certain sub-categories of the site inventories [@damlien2016]. Some studies have attempted more comprehensive evaluations of entire lithic assemblages to get at potential site types and associated mobility patterns [@viken2018a; @breivik2020], but these have predominantly been conducted without support from quantitative frameworks that can help structure such analyses. In sum, therefore, previous studies are typically either limited to a small number of sites, to a subset of the inventories, or to narratively and subjectively driven methods. The analysis conducted here employs multivariate exploratory statistics using the entirety of the lithic assemblages associated with a larger number of sites. This is done to identify latent patterns and structure in the relationship between these, with the ultimate aim of identifying behaviourally induced variation in their composition across time and space. However, the composition of the assemblages can be expected to be determined by a multitude of factors [e.g. @dibble2017], ranging from the impact of natural formation processes, to various and intermixed behavioural aspects such as purpose, duration, frequency, and group sizes at visits to the sites. Furthermore, the assemblages are also likely to be impacted by variation in lithic technology, artefact function, use-life and discard patterns, as well as access to raw materials. Finally, analytical and methodological dimensions relating to survey, excavation and classification practices are also fundamental to how the assemblages are defined. Consequently, the analysis conducted here is done from an exploratory perspective, where all of these factors should be seen as potential contributors to any observed pattern.

## Archaeological context and material 

A defining characteristic of the Norwegian Mesolithic is that a clear majority of the known sites are located in coastal areas. Furthermore, these coastal sites appear to predominantly have been located on or close to the contemporary shoreline when they were in use [@breivik2018; @solheim2020]. In south-eastern Norway, this pattern is combined with a continuous regression of the shoreline, following from isostatic rebound [e.g. @s√∏rensen1979; @romundset2018]. The fairly rapid shoreline displacement means that the location of the sites tend not to have retained their strategic or ecologically beneficial shore-bound location for long periods of time [cf. @perreault2019, 47]. The shore-bound settlement combined with the rapid shoreline displacement has resulted in a relatively high degree of spatial separation of cumulative palimpsests, to follow the terminology of @bailey2007, while the reconstruction of the trajectory of shoreline displacement allows for a relatively good chronological control of these accumulation events. In other parts of the world, a higher degree of spatial distribution means that while the physical separation of material can help delineate discrete events, this typically comes at the cost of loosing temporal resolution, as any stratigraphic relationship between the events is lost [@bailey2007]. However, as the rate of isostatic rebound has varied throughout the Mesolithic in the region, and local topography and bathymetry will have impacted how rapidly a site lost its shore-bound location, this effect is not evenly distributed in time and space. Thus, while relative sea-level change appears to have reduced the degree of mixing that has occurred in the assemblages, this could vary depending on when and where they were in use, in turn potentially reducing the degree to which their composition can be directly compared - a point that is returned to in the discussion of the results.

The `r nrow(assemblages)` sites chosen for analysis here have a relatively limited geographical distribution. The sites were excavated as part of four larger projects all that took place within the last 15 years [@solheim2013b; @jaksland2014a; @melvold2014b; @reitan2014l; @solheim2017b]. The institution responsible for all of these excavations was the Museum of Cultural History in Oslo. This has led to a considerable overlap in the archaeological personnel involved, and comparable excavation practices across the projects. Furthermore, with these projects, major efforts were made to standardise how lithic artefacts were to be classified. As a result, this should reduce the amount of artificial patterning in the data incurred by discrepancies in the employed systems for categorisation [e.g. @clark2006; @dibble2017]. In this setting, for example, bias could potentially follow from the fact that two of the projects have sites with relatively contemporaneous dates [@solheim2013b; @jaksland2014]. Any project-dependent classification practice could as a consequence lead to an exaggeration of chronological differences. While certainly difficult to fully account for, I do believe that the relative contemporaneity of the projects, as well as the overlap in excavation and classification practices should minimise the above-mentioned effects, making the data-set a good candidate for exploratory data analysis aimed at revealing behavioural rather than analytical patterning.

## Methods

Although each individual assemblage can potentially have been impacted by an infinitude of effects that might skew an archaeological interpretation, this does not preclude the applicability of inductive analyses aimed at revealing overarching structure in the data, without having to impose overly complex analytical frameworks that attempt to account for these particularities [@bevan2015]. Structure that can be revealed from considering all of the assemblages in aggregate should be of value to any subsequent in-depth studies of individual sites, and as a step in an iterative analytical chain that ultimately aims to tease apart such aspects from the multitude of factors that have shaped the composition of the assemblages. The most immediate danger of the approach outlined here is rather to be overly naive in the causal significance and cultural importance that is ascribed to any identified pattern. As such, the main aim of this analysis is to compare the results with findings reported in the literature, and have the generation of new hypotheses as a possible outcome. To this end, the analysis follows two analytical avenues.

The first part of the analysis involves employing the method of correspondence analysis (CA), using the lithic count data as classified in the original excavation reports. The purpose of this exercise is to evaluate the degree to which the assemblages follow a chronological structure as has been suggested by previous literature based on more informally driven methods. While some artefact categories will be combined in an attempt to reduce the amount of subjective discretion that can be expected to have impacted the classification of the individual assemblages, this will largely involve an analysis that assumes that the artefact categories employed in Norwegian Stone Age archaeology are, at least to a certain extent, behaviorally meaningful. However, given the vast inferential leap that this assumption involves, the second part of the analysis employs a suite of measures developed for the classification of lithic assemblages developed with this limitation in mind. These measures are taken from the framework of whole assemblage behavioural index, as developed by , and is aimed to get at more specific behavioural dimensions relating to mobility patterns among hunter-gatherers. Through a series of studies, show that the relationship between lithic volumetric density and relative frequency of retouched artefacts provides consistent and comparable results across a wide range of chronological and cultural context. These measures have, however, to my knowledge not seen application in Scandinavian archaeology as of yet. Following the continuous operationalisations of these measures, principal components analysis (PCA) is more suitable than CA for this part of the analysis [e.g. @baxter1994, 100; @Bicho2020].

# Theory/calculation

# Results

```{r wrangling}
sites <- assemblages %>% 
      # Find mean age for each site (to be used in the plot below)
  rowwise() %>% 
  mutate(mean_date = mean(c(reported_start_bp, reported_end_bp)),
         .keep = "unused") %>% 
  mutate(
    artefact_count = sum(c_across(core:flake_retouch_other))) %>% 
  filter(artefact_count > 100)
  

lithics <- sites %>%
  # Combine flint projectiles into a single variable
  mutate(
    projectile = microlith + tanged_point + transverse_point + 
    single_edged_point + hognipen_point + projectile_undefined,
    small_tool = scraper + knife + burin + drill + blade_retouch + 
      microblade_retouch + chip_retouch + fragment_retouch + flake_retouch,
    macro_tool = axe + chisel, 
    macro_tool_other = axe_other + chisel_other + club_hatchet_other,
    small_tool_other = knife_other + scraper_other + drill_other + 
      microblade_retouch_other + blade_retouch_other + fragment_retouch_other +
      flake_retouch_other,
    .keep = "unused") %>%
  # Make site names the rownames
  column_to_rownames(var = "site") %>% 
  # Deselect a few of the columns not be used
  select(-one_of(c("n", "excavation_project", "excavated_m3")))
```

```{r cor1, fig.cap = "Correspondence analysis using artefact count data.", fig.height = 8, fig.width = 10}
# Perform correspondence analysis on the data. 'mean_age' is meant for colouring
# so is excluded here
calithics <- CA(select(lithics, -mean_date, -artefact_count), graph = FALSE)

# Retrieve eigenvalues
eigval <- get_eigenvalue(calithics)
explained_cumul_dim2 <- eigval[2,3]

# Find date to hold the central tendency date
centdate <- (sum(range(lithics$mean_date)) / 2) / 1000

# Plot with site names tags (probably most immediately relevant for an audience 
# familiar with the sites)
fviz_ca_row(calithics, col.row = "black", fill = lithics$mean_date / 1000, title = "A",
                     repel = TRUE, shape = 21, pointsize = 2.9) +
  scale_fill_gradient2(name = "ka BP", low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 
```

```{r cor, fig.cap = "Correspondence analysis using artefact count data. A) Object map, B) Variable map.", fig.height = 13}
# Plot without site names tags
plt1 <- fviz_ca_row(calithics, geom = "point", col.row = "black", fill = lithics$mean_date / 1000, title = "A",
                     repel = TRUE, shape = 21, pointsize = 2.9) +
  scale_fill_gradient2(name = "ka BP", low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 
#guide(fill = guide_legend(reverse = TRUE)) # Reverses the legend but makes it
                                            # discrete

# Plot variables
plt2 <- fviz_ca_col(calithics, col.col = "black", repel = TRUE, title = "B") 

plt1 /
plt2

```

Figure \@ref(fig:cor) displays the CA using the lithic count data. While no clear-cut clusters can be readily delineated, the general impression from the plots is still that a chronological dimension is associated with the patterning in the data. This is indicated by the general transition across the colour scale in the row plot (Figure \@ref(fig:cor)A), combined with the fact that the two first dimensions of the CA-analysis account for as much as `r round(explained_cumul_dim2, 2)` % of the inertia or variance in the data. The earliest sites tend to be located in the upper right corner of plot A, with increasingly younger sites towards the bottom along the second dimension. The sites from the later parts of the Mesolithic are drawn out along the first dimension of the plot, and are not as impacted by the second dimension.

The column plot (Figure \@ref(fig:cor)B) reveals that the earliest sites are characterised by the flint artefact categories microburins, projectiles, as well as macro tools and associated debitage. It is also interesting that these sites to larger extent are characerised by core fragments, both in flint and non-flint materials, while the cores themselves appear to be a trait more defining of assemblages with later dates. The non-flint material on the earliest sites appears to be centered around the production of projectiles, as both the projectiles themselves and non-flint blades are important constituents of the assemblages at these sites.

The first dimension, which is pulling some of the later sites towards the right of the plot, is mainly defined by macro tools and associated debitage in non-flint materials that are negatively correlated with more flint dominated assemblages and non-flint projectiles. While the outer end of the first dimensions is dominated by later Mesolithic sites associated with axe production in non-flint materials, the later sites occur along the entire dimension, indicating that while these axe production sites are a feature of the later Mesolithic, there is marked variation among these later sites. Although the sample size is quite strained and the discussion of finer chronological points might not be warranted, the first dimension does appear to be of of less importance for the absolute latest sites, as indicated by their location to the left of the plot. This could indicate that specialised axe production sites disappear towards the end of the Mesolithic, a notion that would be in line with previous research.

In sum, the results of the CA does appear to align reasonably well with previous research that has been based on more informal analyses of artefact types, indicating that the employed artefact categories are capturing some behaviorally meaningful patterning that changes over time. However, as several authors have pointed out in relation to the application of CA for seriation purposes, 'time is not the only dimension'. This is evident in the present data as well, highlighted by the influence of the later Mesolithic axe production sites, which it would be reasonable to assume corresponds to a more pervasive cultural change than a purely typo-chronological development of artefact shape. Unpicking and aligning the signficance of these chronological patterns with any specific behavioural dimensions using the CA results is, however, another task entirely. This follows most clearly from the fact that for the most part we lack even a most basic understanding of what any individual lithic object has been used for, leaving the significance of the employed units of analysis unclear [@dibble2017].

In addition, Nedre Hobekk 2 represents a somewhat curious case in that its assemblage is dominated by axe production in metarhyolite. The use of metarhyolite is typically seen as a feature of the end of the EM and the MM, but is evidently not as prominent a part of other sites that are contemporaneous with Nedre Hobekk 2.

# 

For example, a vast amount of artefacts defined as debitage are likely to have fulfilled the function of tools, and both debitage and formal tool types could have had various different purposes and had a multitude of shapes throughout their use-life. While use-wear analysis can help identify what an artefact was used for towards the end of its use-file, these are typically only conducted on artefacts already grouped into a single category based on on .

Reducing the number of such inferential leaps by aggregating artefact groups could potentially subsume important variation, but it does also reduce the possibility that the conclusions of any analysis is not simply the result of the employed units of analysis, and an overly naive trust in the fact that these units reflect any behaviourally meaningful categories. This realisation has led to a wide range of outside Scandinavian Mesolithic research, meaning a range of empirical measures associated with various mobility patterns are available.

Within this framework, retouch is viewed as a means of extending the use-life of lithics by repeated rejuvination and modification of edges. At logistical basecamps the extended time spent in a single location would imply a better control of raw material availability, and allow for longer trips to retrieve these. Higher availability of lithic raw materials should in turn reduce the necessity for extensive retouch, meaning the material expectation for logistical basecamps would be relatively high density of lithics and a low relative frequency of retouched artefacts. Higher degree of mobility, on the other hand, would mean a higher dependency on artefacts and material groups could bring with them, and dimensions such as weight, reliabilty, repairability and the degree to which artefacts could be manipulated to fulfill a wide range of tasks would likely have been of concern. From this it follows that the empirical expectation for short-term camps is a higher relative frequency of retouched artefacts, and a lower overall density of lithics [@clark2017].

Of these the most well-estbalished is the. base don the assumption that, this measure and has been shown to display a meaningful measure across a wide range of temporal, geographical and cultural contexts.

```{r pcadata}
# Tried to do this to avoid having to type the variable names into both mutate()
# and select(). The general syntax select(-(vector_of_variable_names)) worked,
# but not: mutate(new_varaible = sum(vector_of_variable_names) / artefact_count)
primary_lithics <- c("core", "core_fragment", "blade", "microblade", "chip",
                     "fragment", "flake", "flake_other", "fragment_other", 
                     "chip_other", "blade_other",  "microblade_other", 
                     "core_other", "core_fragment_other")

secondary_lithics <- c("axe_debitage", "axe", "chisel", "microlith", 
"tanged_point", "transverse_point", "single_edged_point", "hognipen_point",
"projectile_undefined", "microburin", "scraper", "knife", "burin", "drill", 
"blade_retouch", "microblade_retouch", "chip_retouch", "fragment_retouch",
"flake_retouch", "axe_other", "axe_debitage_other", "chisel_other",
"club_hatchet_other", "grinding_slab_stone", "projectile_point_other",
"knife_other", "scraper_other", "drill_other", "microblade_retouch_other", 
"blade_retouch_other", "fragment_retouch_other", "flake_retouch_other")

lithics2 <- assemblages %>% 
  select(-n, -beach_flint_flint_nodule, -hammerstone, -excavation_project) %>% 
  # The reason for not using .keep below is for the option to retain artefact_count
  mutate(chip_freq =  sum(chip, chip_other) / artefact_count,
         core_freq = sum(core, core_other) / artefact_count,
         primary_freq = sum(core, core_fragment, blade, 
                     microblade, chip, fragment, flake, flake_other, 
                     fragment_other, chip_other, blade_other,  microblade_other, 
                     core_other, core_fragment_other) / artefact_count,
         secondary_freq =  sum(axe_debitage, axe, chisel, 
                microlith, tanged_point, transverse_point, single_edged_point,
                hognipen_point, projectile_undefined, microburin, scraper, 
                knife, burin, drill, blade_retouch, microblade_retouch, 
                chip_retouch, fragment_retouch, flake_retouch, axe_other,
                axe_debitage_other, chisel_other, club_hatchet_other, 
                grinding_slab_stone, projectile_point_other, knife_other,
                scraper_other, drill_other, microblade_retouch_other, 
                blade_retouch_other, fragment_retouch_other,
                flake_retouch_other) / artefact_count,
         lithic_dens = artefact_count / excavated_m3) %>%
  select(-primary_lithics, -secondary_lithics, -excavated_m3, -artefact_count) %>% 
  column_to_rownames("site")
```

```{r wabi, fig.cap = "Whole-assemblage behavioural index", fig.height = 5, fig.width = 10}

ggplot(lithics2, aes(log10(lithic_dens), log10(secondary_freq * 100), 
                     fill = mean_date / 1000)) + 
  geom_point(shape = 21, size = 3) +
  geom_smooth(method = "lm", col = "black", se = FALSE) +
  labs(x = "Lithic volumetric density (log10)", 
       y = "Relative frequency of secondarily worked lithics (log10)") +
  scale_fill_gradient2(name = "ka BP",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme_classic()

wabicor <- cor(log10(lithics2$lithic_dens), log10(lithics2$secondary_freq))
```

Figure \@ref(fig:wabi) displays the WABI as found for the site data. This indicates a negative correlation between the two variables (pearsons r = `r round(wabicor, 2)`) and a general tendency for younger sites to be associated with a higher volumetric density of lithics and a lower relative frequency of secondarily worked lithics than older sites. Following @clark2017, this would be in line with a general transition from a expedient to curated lithic technology.

```{r pca-analysis, fig.cap = "PCA.", fig.height = 7, fig.width = 10}
pcalithics <- PCA(select(lithics2, -mean_date), scale.unit = TRUE, graph = FALSE)
fviz_pca(pcalithics, geom.ind = "point", fill.ind = lithics2$mean_date / 1000, 
          repel = TRUE, col.var = "black", pointshape = 21,  pointsize = 2.9,
         title = "") + 
  scale_fill_gradient2(name = "ka BP",  low="yellow", mid="orange", 
                        high="red", midpoint = centdate) +
  theme(legend.position = "bottom") 

```

Figure \@ref(fig:pca-analysis) displays a principle components analysis using variations of the continuous measures for degree of mobility as operationalised by @Bicho2020. While the investigation performed by @Bicho2020 indicates that the relative frequency of chips, cores, and blanks might be more sensitive to mobility patterns than the volumetric density of lithics, and the frequency of retouched artefacts, these last dimensions are capturing the most variation in the dataset presented here. If frequency of secondarily worked artefacts is taken as a proxy for mobility, these findings would consequently be in line with previous research into the Mesolithic of Norway, indicating that earlier sites are associated with higher degree of mobility that sites from later phases. @Bicho2020 also found that WABI, as introduced by, gave a reasonable estimation of mobility in their data. The same is evident here where fig indicates a

```{r eigenvalues, fig.cap = "Table showing the eigenvalues of the components."}
# Scree plot indicates an 'elbow' at the second dimension. 
# The two first dimension account for 68 % and the first three
# for 87 % (see table below)
# fviz_screeplot(pcalithics, addlabels=TRUE)

# Create a table showing the eigenvalues of the components
round(as.tibble(get_eig(pcalithics)), 2) %>% 
  rename("Eigenvalue" = eigenvalue, "Variance (%)" = variance.percent, 
         "Cumulative variance (%)" = cumulative.variance.percent) %>% 
  rownames_to_column(var = "Component") %>% 
gt(rowname_col = "row", auto_align = FALSE)
```

```{r var_contrib, fig.cap = "Contribution of variables to components."}
# The plots below investigates the contribution of the variables to the
# components. The code has in large part been taken from 
# Bicho & Cascalheira (2020).
var <- get_pca_var(pcalithics)
dim1 <- fviz_contrib(pcalithics, choice = "var", axes = 1,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 1")
dim2 <- fviz_contrib(pcalithics, choice = "var", axes = 2, 
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 2")
dim3 <- fviz_contrib(pcalithics, choice = "var", axes = 3,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 3")
dim4 <- fviz_contrib(pcalithics, choice = "var", axes = 4,
                     color = "black", fill = "gold2", 
                     title = "Contribution of variables to Component 4")

# Patchwork for arranging plots
(dim1 | dim2) /
(dim3 | dim4)
```

```{r var_cor, fig.cap = "Plots showing the correlation between the variables"}
plt1 <- fviz_pca_var(pcalithics,
                  col.var = "black",
                  title = "Correlation plot: Component 1/Component 2",
                  repel = TRUE
                  )
plt2 <- fviz_pca_var(pcalithics,
                  col.var = "black",
                  axes = 3:4,
                  title = "Correlation plot: Component 3/Component 4",
                  repel = TRUE
                  )

plt1 + plt2
```

# Discussion

The consistent nature of the negative correlation between LVD and relative retouch frequency across this study (r = -0.50), @clark2017 (r = -0.50) and @Bicho2020 (r = -0.48) is striking. While this result is perhaps not surprising, given the previous indications of the same trends, these results do speak to the cross-cultural and cross-temporal applicability of the measure, and consequently the potential it holds for comparative studies. The findings indicated by the WABI, as well as by the negative correlation between relative frequency of primarily and secondarily worked lithics, do align more clearly with previous suggestions concerning the overall mobility patterns in Mesolithic Norway. However, while this can perhaps support the of the . The question then becomes what is the significance of the negatively correlated variables of relative frequency of cores and chips? Given that these are more or less orthogonal to the WABI variables on the first and second component, this would indicate that if one of these variable pairs is taken to reflect the of expedient and curated assemblages, it should follow that the other variable pairs is not correlated with these. As the entire temporal range of the sites is spread out between the extremes of the chip and core variables, another possibility is that these are indicative of site types that are temporally ubiquitous. In attempt to determine if this might be the case, it was decided to introduce locational data from a previous study that in addition to surveyed sites involved the analysis of the sites treated here @roalkvam2020. This found that the most consistently important locational variable for the sites in the region was the exposure of the sites to the elements, and failed to identify any diachronic variation in this pattern. As it has previously been proposed that sites located in areas exposed to wind and waves and with large overview of surrounding areas is a characteristic of hunting stations or similar, one could envisage that variablity in site functionality indicated by the core to chip correlation might be reflected in variation in degree of exposure.

This is arguably more established than the variables included bysimilarities between the variable plots of @Bicho2020 and the variables indicated in is striking. This pertains to the negative correlation between core and chip frequency, and the negative correlation between primary and secondarily worked lithics. This last

<!-- The following line inserts a page break  -->

\newpage

# References

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

::: {#refs}
:::

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies:

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
